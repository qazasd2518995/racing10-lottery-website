<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£ç†ç®¡ç†ç³»ç»Ÿ - FSé‡‘å½©èµ›è½¦</title>
    
    <!-- æ·»åŠ ç·©å­˜æ¸…é™¤å‚æ•° -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- è‡ªå®šä¹‰æ¨£å¼ - æ·»åŠ ç‰ˆæœ¬è™Ÿé˜²æ­¢ç·©å­˜ -->
    <link rel="stylesheet" href="css/main.css?v=20250723001">
    <style>
        /* é˜²æ­¢Vueæ¨¡æ¿é—ªç¾ */
        [v-cloak] {
            display: none !important;
        }
        
        /* å¼€å¥–å·ç çƒæ¨£å¼ - ä¸éŠæˆ²ç«¯ä¸€è‡´ */
        .draw-number-badge.color-1 { background-color: #ffcc00; color: #000; } /* é‡‘é»„è‰² */
        .draw-number-badge.color-2 { background-color: #3399ff; color: #fff; } /* é²œè—è‰² */
        .draw-number-badge.color-3 { background-color: #777777; color: #fff; } /* æ·±ç°è‰² */
        .draw-number-badge.color-4 { background-color: #ff9933; color: #fff; } /* æ©™è‰² */
        .draw-number-badge.color-5 { background-color: #00ccff; color: #fff; } /* å¤©è—è‰² */
        .draw-number-badge.color-6 { background-color: #9966cc; color: #fff; } /* ç´«è‰² */
        .draw-number-badge.color-7 { background-color: #aaaaaa; color: #fff; } /* ç°è‰² */
        .draw-number-badge.color-8 { background-color: #ff3333; color: #fff; } /* ç´…è‰² */
        .draw-number-badge.color-9 { background-color: #990000; color: #fff; } /* æ·±ç´…è‰² */
        .draw-number-badge.color-10 { background-color: #33cc33; color: #fff; } /* ç¶ è‰² */
        .draw-number-badge.color-0 { background-color: #33cc33; color: #fff; } /* ç¶ è‰² (0ä¸10åŒè‰²) */
        
        /* åŠ è½½é®ç½©å±¤ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            transition: opacity 0.3s ease-in-out;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* éªŒè¯ç¢¼æ¨£å¼ */
        .captcha-group {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .captcha-input {
            flex: 1;
        }

        .captcha-display {
            width: 120px;
            height: 38px;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border: 1px solid #ced4da;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            color: #495057;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .captcha-display:hover {
            background: linear-gradient(45deg, #e9ecef, #dee2e6);
            border-color: #adb5bd;
            transform: translateY(-1px);
        }

        .refresh-btn {
            padding: 6px 12px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            transform: translateY(-1px);
        }
        
        /* åŸºæœ¬æ¨£å¼ */
        body {
            font-family: 'Microsoft JhengHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #f8f9fa;
        }
        /* ... å…¶ä»–ç¾æœ‰æ¨£å¼ ... */

        /* æ·»åŠ çƒå·é¢œè‰²è¦å‰‡ */
        .number-ball {
            width: 28px; /* æ ¹æ®éœ€è¦è°ƒæ•´å¤§å° */
            height: 28px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px; /* æ ¹æ®éœ€è¦è°ƒæ•´å¤§å° */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            margin: 0 2px; /* æ·»åŠ ä¸€äº›é—´è· */
            color: #fff; /* é¢„è¨­æ–‡å­—é¢œè‰² */
        }

        /* ä¸æ¸¸æˆå‰ç«¯ä¸€è‡´çš„é¢œè‰² */
        .color-1 { background-color: #ffcc00; color: #000; } /* é‡‘é»„è‰² */
        .color-2 { background-color: #3399ff; color: #fff; } /* é²œè—è‰² */
        .color-3 { background-color: #777777; color: #fff; } /* æ·±ç°è‰² */
        .color-4 { background-color: #ff9933; color: #fff; } /* æ©™è‰² */
        .color-5 { background-color: #00ccff; color: #fff; } /* å¤©è—è‰² */
        .color-6 { background-color: #9966cc; color: #fff; } /* ç´«è‰² */
        .color-7 { background-color: #aaaaaa; color: #fff; } /* ç°è‰² */
        .color-8 { background-color: #ff3333; color: #fff; } /* ç´…è‰² */
        .color-9 { background-color: #990000; color: #fff; } /* æ·±ç´…è‰² */
        .color-10 { background-color: #33cc33; color: #fff; } /* ç¶ è‰² */
        
        /* å¼€å¥–çƒè™Ÿæ¨£å¼ - ä¸éŠæˆ²ç«¯ä¸€è‡´ */
        .bg-purple {
            background-color: #6f42c1 !important;
        }
        
        .bg-teal {
            background-color: #20c997 !important;
        }
        
        /* å¼€å¥–çƒè™Ÿçµ±ä¸€æ¨£å¼ */
        .draw-number-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-weight: bold;
            font-size: 14px;
            margin: 0 3px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            transition: transform 0.2s ease;
        }
        
        .draw-number-badge:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <script>
        // æª¢æŸ¥æ˜¯å¦æ‡‰è©²ä½¿ç”¨æ–°çš„ç™»å…¥é é¢
        const agentToken = localStorage.getItem('agent_token');
        const agentUser = localStorage.getItem('agent_user');
        
        if (!agentToken || !agentUser) {
            // å¦‚æœæœªç™»å…¥ï¼Œç«‹å³é‡å®šå‘åˆ°æ–°çš„ç™»å…¥é é¢
            window.location.replace('/login.html');
            // åœæ­¢åŸ·è¡Œå¾ŒçºŒä»£ç¢¼
            throw new Error('Redirecting to login page');
        }
    </script>
    
    <!-- åˆå§‹åŠ è½½é®ç½©å±¤ -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <h4>ä»£ç†ç®¡ç†ç³»ç»Ÿ</h4>
        <p>æ­£åœ¨è½½å…¥ä¸­...</p>
    </div>
    
    <div id="app" v-cloak>
        <!-- ç™»å½•é¡µé¢ (æ‡‰è©²ä¸æœƒé¡¯ç¤ºï¼Œå› ç‚ºæœƒé‡å®šå‘) -->
        <div v-if="!isLoggedIn" class="container login-container" style="display: none;">
            <div class="row justify-content-center">
                <div class="col-md-6 col-lg-5">
                    <div class="card shadow">
                        <div class="card-header bg-primary text-white">
                            <h3 class="text-center mb-0">ä»£ç†ç®¡ç†ç³»ç»Ÿ</h3>
                        </div>
                        <div class="card-body">
                            <form @submit.prevent="login">
                                <div class="form-group mb-3">
                                    <label for="username">ç”¨æˆ¶å</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                                        <input type="text" id="username" v-model="loginForm.username" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ¶å" required>
                                    </div>
                                </div>
                                <div class="form-group mb-3">
                                    <label for="password">å¯†ç </label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                        <input type="password" id="password" v-model="loginForm.password" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç " required>
                                    </div>
                                </div>
                                <div class="form-group mb-3">
                                    <label for="captcha">éªŒè¯ç¢¼</label>
                                    <div class="captcha-group">
                                        <input 
                                            type="text" 
                                            id="captcha" 
                                            v-model="loginForm.captcha"
                                            class="form-control captcha-input" 
                                            placeholder="è¯·è¾“å…¥éªŒè¯ç¢¼"
                                            required
                                            maxlength="4"
                                            style="text-transform: uppercase;"
                                        >
                                        <div class="captcha-display" id="captchaDisplay" @click="refreshCaptcha">
                                            {{ currentCaptcha }}
                                        </div>
                                        <button type="button" class="btn btn-outline-primary refresh-btn" @click="refreshCaptcha" title="é‡æ–°æ•´ç†éªŒè¯ç¢¼">
                                            ğŸ”„
                                        </button>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="remember">
                                        <label class="form-check-label" for="remember">è¨˜ä½æˆ‘</label>
                                    </div>
                                    <button type="submit" class="btn btn-primary" :disabled="loading">
                                        <span v-if="loading" class="spinner-border spinner-border-sm" role="status"></span>
                                        ç™»å½•
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»é¡µé¢ -->
        <div v-else>
            <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">ä»£ç†ç®¡ç†ç³»ç»Ÿ</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item" v-if="!isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'dashboard'}" href="#" @click="setActiveTab('dashboard')">å„€è¡¨æ¿</a>
                            </li>
                            <li class="nav-item dropdown" v-if="!isSubAccount">
                                <a class="nav-link dropdown-toggle" :class="{active: activeTab === 'accounts' || activeTab === 'subaccounts'}" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    å¸³è™Ÿç®¡ç†
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" @click.prevent="setActiveTab('accounts')">ä»£ç†ï¼†ä¼šå‘˜</a></li>
                                    <li><a class="dropdown-item" href="#" @click.prevent="setActiveTab('subaccounts')">å­å¸³è™Ÿ</a></li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" :class="{active: activeTab === 'reports'}" href="#" @click="setActiveTab('reports')">æŠ¥è¡¨æŸ¥è¯¢</a>
                            </li>
                            <li class="nav-item" v-if="!isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'transactions'}" href="#" @click="setActiveTab('transactions')">äº¤æ˜“è®°å½•</a>
                            </li>
                            <li class="nav-item" v-if="!isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'draw'}" href="#" @click="setActiveTab('draw')">å¼€å¥–è®°å½•</a>
                            </li>
                            <li class="nav-item" v-if="!isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'notices'}" href="#" @click="setActiveTab('notices')">ç³»ç»Ÿå…¬å‘Š</a>
                            </li>
                            <li class="nav-item" v-if="!isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'login-logs'}" href="#" @click="setActiveTab('login-logs')">ç™»å½•æ—¥èªŒ</a>
                            </li>
                            <li class="nav-item" v-if="user.level === 0 && !isSubAccount">
                                <a class="nav-link" :class="{active: activeTab === 'customer-service'}" href="#" @click="setActiveTab('customer-service')">å®¢æœåŠŸèƒ½</a>
                            </li>
                        </ul>
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item me-3">
                                <a class="nav-link">
                                    <i class="fas fa-wallet me-1"></i>é¢åº¦: {{ formatMoney(user.balance) }}
                                </a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user-circle me-1"></i>{{ user.username }}
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#" @click.prevent="showProfileModal()">
                                        <i class="fas fa-user-edit me-2"></i>ä¸ªäººèµ„æ–™
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" @click.prevent="showChangePasswordModal()">
                                        <i class="fas fa-key me-2"></i>æ›´æ”¹å¯†ç 
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="#" @click="logout">
                                        <i class="fas fa-sign-out-alt me-2"></i>ç™»å‡º
                                    </a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <!-- å…¨åŸŸæ–°å¢ä¼šå‘˜æ¨¡æ…‹æ¡† - ä¸å—é¡µç±¤é™åˆ¶ï¼Œä»»ä½•é¡µé¢éƒ½å¯ä»¥ä½¿ç”¨ï¼Œåªåœ¨ç™»å½•å¾Œæ˜¾ç¤º -->
            <div id="createMemberModal" v-if="showCreateMemberModal && isLoggedIn && user && user.id && modalSystemReady" 
                 style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.85); z-index: 99999; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(3px);">
                
                <!-- æ¨¡æ…‹æ¡†ä¸»ä½“ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 3px; border-radius: 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.4); max-width: 500px; width: 90%; max-height: 90vh; overflow: auto;">
                    <div style="background: white; border-radius: 12px; overflow: hidden;">
                        
                        <!-- æ¨¡æ…‹æ¡†æ ‡é¢˜ -->
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; position: relative;">
                            <h4 style="margin: 0; font-weight: 600; text-align: center;">
                                <i class="fas fa-user-plus me-2"></i>
                                {{ (currentManagingAgent && currentManagingAgent.id === user.id) || !currentManagingAgent ? 'æ–°å¢ä¼šå‘˜' : 'ä¸º ' + (currentManagingAgent ? currentManagingAgent.username : '') + ' æ–°å¢ä¼šå‘˜' }}
                            </h4>
                            <button type="button" @click="hideCreateMemberModal" 
                                    style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); border: none; color: white; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.3)'"
                                    onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- æ¨¡æ…‹æ¡†å†…å®¹ -->
                        <div style="padding: 30px;">
                            <!-- ä»£ç†ä¿¡æ¯æ˜¾ç¤º -->
                            <div v-if="currentManagingAgent" style="background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 25px; border-left: 4px solid #667eea;">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-crown me-2 text-warning"></i>
                                    <span class="fw-bold">ä»£ç†:</span>
                                    <span class="ms-2 text-primary fw-bold">{{ currentManagingAgent.username }}</span>
                                    <span class="badge bg-info ms-2">{{ getLevelName(currentManagingAgent.level || 1) }}</span>
                                </div>
                            </div>
                            
                            <!-- è¡¨å–® -->
                            <form @submit.prevent="createMember">
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        <i class="fas fa-user me-1 text-primary"></i>ç”¨æˆ¶å
                                    </label>
                                    <input type="text" class="form-control form-control-lg" 
                                           v-model="newMember.username" 
                                           placeholder="è¯·è¾“å…¥ä¼šå‘˜ç”¨æˆ¶å" 
                                           style="border-radius: 8px; border: 2px solid #e9ecef; transition: all 0.2s;"
                                           onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)'"
                                           onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none'"
                                           required>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        <i class="fas fa-lock me-1 text-primary"></i>å¯†ç 
                                    </label>
                                    <input type="password" class="form-control form-control-lg" 
                                           v-model="newMember.password" 
                                           placeholder="è¯·è¾“å…¥å¯†ç " 
                                           style="border-radius: 8px; border: 2px solid #e9ecef; transition: all 0.2s;"
                                           onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)'"
                                           onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none'"
                                           required>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        <i class="fas fa-lock me-1 text-primary"></i>ç¡®è®¤å¯†ç 
                                    </label>
                                    <input type="password" class="form-control form-control-lg" 
                                           v-model="newMember.confirmPassword" 
                                           placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç " 
                                           style="border-radius: 8px; border: 2px solid #e9ecef; transition: all 0.2s;"
                                           onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)'"
                                           onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none'"
                                           required>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        <i class="fas fa-sticky-note me-1 text-primary"></i>å¤‡æ³¨è¯´æ˜
                                    </label>
                                    <textarea class="form-control form-control-lg" 
                                              v-model="newMember.notes" 
                                              placeholder="è¯·è¾“å…¥ä¼šå‘˜å¤‡æ³¨è¯´æ˜ï¼ˆé€‰å¡«ï¼‰" 
                                              rows="3"
                                              style="border-radius: 8px; border: 2px solid #e9ecef; transition: all 0.2s; resize: vertical;"
                                              onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)'"
                                              onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none'"></textarea>
                                    <small class="form-text text-muted">
                                        <i class="fas fa-info-circle me-1"></i>
                                        å¯ç”¨æ–¼è®°å½•ä¼šå‘˜çš„ç‰¹æ®Šæƒ…å†µã€è”ç³»æ–¹å¼ã€å‚™å¿˜äº‹é¡¹ç­‰
                                    </small>
                                </div>
                                
                                <!-- æŒ‰é’®å€åŸŸ -->
                                <div class="d-flex justify-content-end gap-3 mt-4">
                                    <button type="button" class="btn btn-outline-secondary btn-lg px-4" 
                                            @click="hideCreateMemberModal"
                                            style="border-radius: 8px; font-weight: 500;">
                                        <i class="fas fa-times me-1"></i>å–æ¶ˆ
                                    </button>
                                    <button type="submit" class="btn btn-lg px-4" 
                                            :disabled="loading"
                                            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; border-radius: 8px; font-weight: 500; min-width: 120px;">
                                        <span v-if="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                                        <i v-else class="fas fa-plus me-1"></i>
                                        {{ loading ? 'å»ºç«‹ä¸­...' : 'å»ºç«‹ä¼šå‘˜' }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åˆ›å»ºå­å¸³è™Ÿæ¨¡æ…‹æ¡† -->
            <div class="modal fade" id="createSubAccountModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-user-shield me-2"></i>æ–°å¢å­å¸³è™Ÿ
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form id="createSubAccountForm" @submit.prevent="createSubAccount">
                                <div class="mb-3">
                                    <label class="form-label">å­å¸³è™Ÿåç§°</label>
                                    <input type="text" class="form-control" v-model="newSubAccount.username" 
                                           placeholder="è¯·è¾“å…¥å­å¸³è™Ÿåç§°" required>
                                    <small class="form-text text-muted">å­å¸³è™Ÿåç§°å¿…é¡»å”¯ä¸€</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">å¯†ç </label>
                                    <input type="password" class="form-control" v-model="newSubAccount.password" 
                                           placeholder="è¯·è¾“å…¥å¯†ç " required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">ç¡®è®¤å¯†ç </label>
                                    <input type="password" class="form-control" v-model="newSubAccount.confirmPassword" 
                                           placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç " required>
                                </div>
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    å­å¸³è™Ÿåˆ›å»ºå¾Œåªèƒ½æŸ¥çœ‹æŠ¥è¡¨ï¼Œç„¡æ³•è¿›è¡Œå…¶ä»–æ“ä½œã€‚
                                </div>
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                    <button type="submit" class="btn btn-primary" :disabled="loading">
                                        <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                                        {{ loading ? 'å»ºç«‹ä¸­...' : 'å»ºç«‹å­å¸³è™Ÿ' }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é‡è¨­å­å¸³è™Ÿå¯†ç æ¨¡æ…‹æ¡† -->
            <div class="modal fade" id="resetSubAccountPasswordModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-key me-2"></i>é‡è¨­å­å¸³è™Ÿå¯†ç 
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form @submit.prevent="resetSubAccountPassword">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    æ­£åœ¨ä¸ºå­å¸³è™Ÿ <strong>{{ resetPasswordSubAccount.username }}</strong> é‡è¨­å¯†ç 
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">æ–°å¯†ç </label>
                                    <input type="password" class="form-control" v-model="resetPasswordSubAccount.newPassword" 
                                           placeholder="è¯·è¾“å…¥æ–°å¯†ç " required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">ç¡®è®¤æ–°å¯†ç </label>
                                    <input type="password" class="form-control" v-model="resetPasswordSubAccount.confirmPassword" 
                                           placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required>
                                </div>
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                    <button type="submit" class="btn btn-primary" :disabled="loading">
                                        <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                                        {{ loading ? 'é‡è¨­ä¸­...' : 'ç¡®è®¤é‡è¨­' }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ›´æ”¹å¯†ç æ¨¡æ…‹æ¡† -->
            <div class="modal fade" id="changePasswordModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-key me-2"></i>æ›´æ”¹å¯†ç 
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form @submit.prevent="changePassword">
                                <div class="mb-3">
                                    <label class="form-label">å½“å‰å¯†ç </label>
                                    <input type="password" class="form-control" v-model="changePasswordForm.currentPassword" 
                                           placeholder="è¯·è¾“å…¥å½“å‰å¯†ç " required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">æ–°å¯†ç </label>
                                    <input type="password" class="form-control" v-model="changePasswordForm.newPassword" 
                                           placeholder="è¯·è¾“å…¥æ–°å¯†ç " required>
                                    <small class="form-text text-muted">å¯†ç é•¿åº¦è‡³å°‘éœ€è¦ 6 ä¸ªå­—ç¬¦</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">ç¡®è®¤æ–°å¯†ç </label>
                                    <input type="password" class="form-control" v-model="changePasswordForm.confirmPassword" 
                                           placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required>
                                </div>
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                    <button type="submit" class="btn btn-primary" :disabled="loading">
                                        <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                                        {{ loading ? 'æ›´æ”¹ä¸­...' : 'ç¡®è®¤æ›´æ”¹' }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-fluid mt-3">
                <!-- å„€è¡¨æ¿ -->
                <div v-if="activeTab === 'dashboard'">
                    <h2>å„€è¡¨æ¿</h2>
                    <!-- ç¬¬ä¸€æ’å¡ç‰‡ - 4ä¸ªä¸»è¦æŒ‡æ ‡ -->
                    <div class="row mt-4">
                        <div class="col-md-3 mb-4">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title mb-1">æˆ‘çš„ç‚¹æ•°ä½™é¢</h5>
                                            <h2 class="card-text mb-0">{{ formatMoney(user.balance) }}</h2>
                                        </div>
                                        <i class="fas fa-wallet fa-2x opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title mb-1">ç¸½ä¼šå‘˜æ•¸</h5>
                                            <h2 class="card-text mb-0">{{ dashboardData.memberCount }}</h2>
                                        </div>
                                        <i class="fas fa-users fa-2x opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title mb-1">ä»Šæ—¥æŠ•æ³¨é¢</h5>
                                            <h2 class="card-text mb-0">{{ formatMoney(dashboardData.totalTransactions) }}</h2>
                                        </div>
                                        <i class="fas fa-chart-line fa-2x opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title mb-1">ä¸‹ç´šä»£ç†æ•¸</h5>
                                            <h2 class="card-text mb-0">{{ dashboardData.subAgentsCount }}</h2>
                                        </div>
                                        <i class="fas fa-sitemap fa-2x opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬äºŒæ’å¡ç‰‡ - è¯¦ç»†ç»Ÿè®¡ -->
                    <div class="row">
                        <div class="col-md-3 mb-4">
                            <div class="card bg-light border-start border-primary border-4">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-1">æ´»èºä¼šå‘˜</h6>
                                            <h4 class="text-primary mb-0">{{ dashboardData.activeMembers }}</h4>
                                        </div>
                                        <i class="fas fa-user-check fa-lg text-primary"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-light border-start border-success border-4">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                                                        <h6 class="text-muted mb-1">ä»£ç†ç›ˆåˆ©</h6>
                            <h4 class="text-success mb-0">{{ formatMoney(dashboardData.totalDeposit) }}</h4>
                                        </div>
                                        <i class="fas fa-arrow-up fa-lg text-success"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-light border-start border-danger border-4">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                                                        <h6 class="text-muted mb-1">ä»£ç†äºæŸ</h6>
                            <h4 class="text-danger mb-0">{{ formatMoney(dashboardData.totalWithdraw) }}</h4>
                                        </div>
                                
                                        <i class="fas fa-arrow-down fa-lg text-danger"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card bg-light border-start border-info border-4">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-1">ä»Šæ—¥æ·¨æ”¶ç›Š</h6>
                                            <h4 class="mb-0" :class="dashboardData.totalRevenue >= 0 ? 'text-success' : 'text-danger'">
                                                {{ formatMoney(dashboardData.totalRevenue) }}
                                            </h4>
                                        </div>
                                        <i class="fas fa-coins fa-lg text-info"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬ä¸‰æ’ - å›¾è¡¨å’Œå…¬å‘Š -->
                    <div class="row">
                        <div class="col-md-8 mb-4">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">è¿‘æœŸäº¤æ˜“è¶‹åŠ¿</h5>
                                    <small class="text-muted">è¿‡å»7å¤©æ•°æ®</small>
                                </div>
                                <div class="card-body">
                                    <canvas id="transactionChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">ç³»ç»Ÿå…¬å‘Š</h5>
                                    <button class="btn btn-sm btn-outline-primary" @click="setActiveTab('notices')">
                                        æŸ¥çœ‹å…¨éƒ¨
                                    </button>
                                </div>
                                <div class="card-body p-0" style="max-height: 300px; overflow-y: auto;">
                                    <div v-if="notices.length === 0" class="p-3 text-center text-muted">
                                        <i class="fas fa-bullhorn fa-2x mb-2"></i>
                                        <div>æš«ç„¡å…¬å‘Š</div>
                                    </div>
                                    <div v-for="notice in notices.slice(0, 5)" :key="notice.id" class="border-bottom p-3">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">{{ notice.title }}</h6>
                                                <p class="mb-1 text-muted small">{{ notice.content.substring(0, 50) }}...</p>
                                                <small class="text-muted">{{ formatDate(notice.created_at) }}</small>
                                            </div>
                                            <span class="badge" :class="{
                                                'bg-primary': notice.category === 'æœ€æ–°å…¬å‘Š',
                                                'bg-warning': notice.category === 'ç¶­ä¿®',
                                                'bg-success': notice.category === 'æ´»å‹•'
                                            }">{{ notice.category }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬å››æ’ - å¿«æ·æ“ä½œ -->
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">å¿«æ·æ“ä½œ</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row g-2">
                                        <div class="col-6">
                                            <button class="btn btn-outline-primary w-100" @click="setActiveTab('accounts')">
                                                <i class="fas fa-users-cog mb-1"></i><br>
                                                <small>å¸³è™Ÿç®¡ç†</small>
                                            </button>
                                        </div>
                                        <div class="col-6">
                                            <button class="btn btn-outline-info w-100" @click="setActiveTab('transactions')">
                                                <i class="fas fa-exchange-alt mb-1"></i><br>
                                                <small>äº¤æ˜“è®°å½•</small>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">ç³»ç»ŸçŠ¶æ€</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-4">
                                            <div class="text-success">
                                                <i class="fas fa-server fa-2x mb-2"></i>
                                                <div>ç³»ç»Ÿæ­£å¸¸</div>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-primary">
                                                <i class="fas fa-database fa-2x mb-2"></i>
                                                <div>æ•°æ®åŒæ­¥</div>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-info">
                                                <i class="fas fa-wifi fa-2x mb-2"></i>
                                                <div>è¿çº¿ç©©å®š</div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="text-center">
                                        <small class="text-muted">
                                            æœ€åæ›´æ–°ï¼š{{ new Date().toLocaleString() }}
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç™»å½•æ—¥èªŒé¡µé¢ -->
                <div v-if="activeTab === 'login-logs'">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>ç™»å½•æ—¥èªŒ</h2>
                        <button class="btn btn-primary" @click="loadLoginLogs()">
                            <i class="fas fa-sync me-1"></i>åˆ·æ–°æ—¥èªŒ
                        </button>
                    </div>

                    <!-- æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">è¯·é€‰æ‹©èµ·æ­¢æ—¶é—´</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">å¼€å§‹æ—¶é—´</label>
                                    <input type="date" class="form-control" v-model="loginLogFilters.startDate">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">ç»“æŸæ—¶é—´</label>
                                    <input type="date" class="form-control" v-model="loginLogFilters.endDate">
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-outline-secondary btn-sm" @click="setLoginLogDateRange('today')">ä»Šæ—¥</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" @click="setLoginLogDateRange('yesterday')">æ˜¨æ—¥</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" @click="setLoginLogDateRange('week')">æœ¬å‘¨</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" @click="setLoginLogDateRange('7days')">æœ€è¿‘7å¤©</button>
                                        <button type="button" class="btn btn-primary btn-sm" @click="searchLoginLogs()">æŸ¥è¯¢</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ç™»å½•æ—¥èªŒæ•°æ®è¡¨æ ¼ -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">ç™»å½•è®°å½•</h5>
                            <span class="badge bg-secondary">å…± {{ loginLogs.length }} ç­†è®°å½•</span>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead style="background-color: #2c3e50;">
                                        <tr>
                                            <th style="width: 80px; color: white; font-weight: bold; background-color: #2c3e50;">NO.</th>
                                            <th style="width: 150px; color: white; font-weight: bold; background-color: #2c3e50;">ç”¨æˆ¶å</th>
                                            <th style="width: 180px; color: white; font-weight: bold; background-color: #2c3e50;">ç™»å½•æ—¶é—´</th>
                                            <th style="width: 150px; color: white; font-weight: bold; background-color: #2c3e50;">IP</th>
                                            <th style="color: white; font-weight: bold; background-color: #2c3e50;">IPæ­¸å±¬åœ°</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(log, index) in paginatedLoginLogs" :key="log.id" class="align-middle">
                                            <td>{{ (loginLogPagination.currentPage - 1) * loginLogPagination.limit + index + 1 }}</td>
                                            <td><strong>{{ log.username || currentUsername }}</strong></td>
                                            <td>{{ formatLoginDateTime(log.login_time) }}</td>
                                            <td><span class="font-monospace">{{ formatIPAddress(log.ip_address) }}</span></td>
                                            <td>{{ log.ip_location || 'æœªçŸ¥ä½ç½®' }}</td>
                                        </tr>
                                        <tr v-if="loginLogs.length === 0">
                                            <td colspan="5" class="text-center text-muted py-4">
                                                æš«ç„¡ç™»å½•è®°å½•
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- åˆ†é¡µæ§åˆ¶ -->
                            <div v-if="loginLogPagination.totalPages > 1" class="d-flex justify-content-between align-items-center mt-3">
                                <div class="text-muted">
                                    æ˜¾ç¤ºç¬¬ {{ (loginLogPagination.currentPage - 1) * loginLogPagination.limit + 1 }} - 
                                    {{ Math.min(loginLogPagination.currentPage * loginLogPagination.limit, loginLogs.length) }} ç­†ï¼Œ
                                    å…± {{ loginLogs.length }} ç­†è®°å½•
                                </div>
                                <nav aria-label="ç™»å½•æ—¥èªŒåˆ†é¡µ">
                                    <ul class="pagination pagination-sm mb-0">
                                        <li class="page-item" :class="{disabled: loginLogPagination.currentPage === 1}">
                                            <a class="page-link" href="#" @click.prevent="changeLoginLogPage(loginLogPagination.currentPage - 1)">
                                                <i class="fas fa-chevron-left"></i>
                                            </a>
                                        </li>
                                        <li v-for="page in getLoginLogPageRange()" :key="page" 
                                            class="page-item" :class="{active: page === loginLogPagination.currentPage}">
                                            <a class="page-link" href="#" @click.prevent="changeLoginLogPage(page)">{{ page }}</a>
                                        </li>
                                        <li class="page-item" :class="{disabled: loginLogPagination.currentPage === loginLogPagination.totalPages}">
                                            <a class="page-link" href="#" @click.prevent="changeLoginLogPage(loginLogPagination.currentPage + 1)">
                                                <i class="fas fa-chevron-right"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <!-- æ³¨æ„äº‹é¡¹ -->
                    <div class="alert alert-info mt-4" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>æ³¨æ„ï¼š</strong>ç™»å½•æ—¥èªŒæœ€å°‘è¢«ä¿ç•™7å¤©ï¼Œè¶…è¿‡7å¤©éƒ¨åˆ†æœ€å¤šä¿ç•™æœ€å20ç­†ã€‚
                    </div>
                </div>

                <!-- å¸³è™Ÿç®¡ç† (åˆå¹¶ä»£ç†ç®¡ç†å’Œä¼šå‘˜ç®¡ç†) -->
                <div v-if="activeTab === 'accounts'">
                    <!-- é¢åŒ…å±‘å°èˆª -->
                    <nav v-if="memberBreadcrumb.length > 0" aria-label="å¸³è™Ÿç®¡ç†å±‚çº§å°èˆª">
                        <ol class="breadcrumb mb-3 bg-light p-2 rounded">
                            <li class="breadcrumb-item">
                                <button class="btn btn-link p-0 text-decoration-none" @click="memberBreadcrumb = []; loadHierarchicalMembers()">
                                    <i class="fas fa-home me-1"></i>æ ¹å±‚çº§ ({{ user.username }})
                                </button>
                            </li>
                            <li v-for="(item, index) in memberBreadcrumb" :key="index" 
                                class="breadcrumb-item"
                                :class="{ 'active': index === memberBreadcrumb.length - 1 }">
                                <span v-if="index === memberBreadcrumb.length - 1" class="fw-bold">
                                    {{ item.username }} ({{ item.levelName || getLevelName(item.level) }})
                                </span>
                                <button v-else class="btn btn-link p-0 text-decoration-none" 
                                        @click="memberBreadcrumb.splice(index + 1); goBackToMemberLevel(item)">
                                    {{ item.username }} ({{ item.levelName || getLevelName(item.level) }})
                                </button>
                            </li>
                            <li v-if="memberBreadcrumb.length > 0" class="breadcrumb-item ms-auto">
                                <button class="btn btn-sm btn-outline-secondary" @click="goBackToParentMember()">
                                    <i class="fas fa-arrow-left me-1"></i>è¿”å›ä¸Šç´š
                                </button>
                            </li>
                        </ol>
                    </nav>

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>
                            <i class="fas fa-users-cog me-2"></i>å¸³è™Ÿç®¡ç†
                        </h2>
                        <div class="d-flex gap-2 align-items-center">
                            <span class="badge bg-info d-flex align-items-center justify-content-center" style="height: 32px; padding: 8px 12px;">
                                å…± {{ hierarchicalMembers ? hierarchicalMembers.length : 0 }} ä¸ªä¸‹ç´š
                                ({{ memberHierarchyStats.agentCount || 0 }}ä»£ç† + {{ memberHierarchyStats.memberCount || 0 }}ä¼šå‘˜)
                            </span>
                            <button class="btn btn-primary me-2" @click="quickCreateMember">
                                <i class="fas fa-user-plus me-1"></i>æ–°å¢ä¼šå‘˜
                            </button>
                            <button v-if="(currentMemberManagingAgent ? currentMemberManagingAgent.level : (currentManagingAgent ? currentManagingAgent.level : user.level)) < 15" 
                                    class="btn btn-success me-2" @click="showAgentModal">
                                <i class="fas fa-plus me-1"></i>æ–°å¢ä»£ç†
                            </button>
                            <button class="btn btn-outline-primary" @click="refreshHierarchicalMembers()">
                                <i class="fas fa-sync me-1"></i>åˆ·æ–°
                            </button>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header">
                            æœç´¢æ¢ä»¶
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label class="form-label">çŠ¶æ€</label>
                                    <select class="form-select" v-model="memberFilters.status" @change="loadHierarchicalMembers">
                                        <option value="-1">å…¨éƒ¨</option>
                                        <option value="1">å¯ç”¨</option>
                                        <option value="0">åœç”¨</option>
                                        <option value="2">å†»ç»“</option>
                                    </select>
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label">å…³é”®å­—</label>
                                    <input type="text" class="form-control" placeholder="ç”¨æˆ¶å/ID" v-model="memberFilters.keyword" @keyup.enter="loadHierarchicalMembers">
                                </div>
                                <div class="col-md-4 d-flex align-items-end">
                                    <button class="btn btn-primary" @click="loadHierarchicalMembers">æœç´¢</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover align-middle">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">çº§åˆ«</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ID</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ä½™é¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å¤‡æ³¨</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">çŠ¶æ€</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">åˆ›å»ºæ—¶é—´</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="hierarchicalMembers.length === 0">
                                            <td colspan="8" class="text-center text-muted py-4">
                                                <i class="fas fa-inbox fa-2x mb-2 d-block"></i>
                                                æ²’æœ‰èµ„æ–™
                                            </td>
                                        </tr>
                                        <tr v-for="item in hierarchicalMembers" :key="item.id">
                                            <td>
                                                <span class="badge" :class="item.userType === 'agent' ? 'bg-primary' : 'bg-success'">
                                                    {{ item.userType === 'agent' ? (item.level == 0 ? 'æ€»ä»£ç†' : getLevelName(item.level)) : 'ä¼šå‘˜' }}
                                                </span>
                                            </td>
                                            <td>{{ item.id }}</td>
                                            <td>
                                                <!-- å¦‚æœæ˜¯ä»£ç†ä¸”çº§åˆ«å°æ–¼15ï¼Œæ˜¾ç¤ºä¸ºå¯ç‚¹æ“Š -->
                                                <div v-if="item.userType === 'agent' && parseInt(item.level) < 15" class="d-flex align-items-center">
                                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary" 
                                                            @click="enterAgentMemberManagement(item)">
                                                        {{ item.username }}
                                                        <i class="fas fa-chevron-right ms-1 small"></i>
                                                    </button>
                                                </div>
                                                <!-- 15ç´šä»£ç†æˆ–ä¼šå‘˜æ˜¾ç¤ºä¸ºæ™®é€šæ–‡å­— -->
                                                <div v-else class="d-flex align-items-center">
                                                    <span class="fw-bold" :class="item.userType === 'agent' ? 'text-primary' : 'text-success'">
                                                        {{ item.username }}
                                                    </span>
                                                    <span v-if="item.userType === 'agent' && parseInt(item.level) >= 15" class="text-muted small ms-2">
                                                        (æœ€å¤§å±‚çº§ï¼Œåªèƒ½åˆ›å»ºä¼šå‘˜)
                                                    </span>
                                                </div>
                                            </td>

                                            <td>{{ formatMoney(item.balance) }}</td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <span v-if="item.notes" class="text-truncate" style="max-width: 150px;" :title="item.notes">
                                                        {{ item.notes }}
                                                    </span>
                                                    <span v-else class="text-muted fst-italic">ç„¡å¤‡æ³¨</span>
                                                    <button class="btn btn-sm btn-outline-secondary ms-2" 
                                                            @click="item.userType === 'agent' ? editAgentNotes(item) : editMemberNotes(item)" 
                                                            :title="item.notes ? 'ç¼–è¾‘å¤‡æ³¨' : 'æ–°å¢å¤‡æ³¨'">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="badge" :class="getStatusBadgeClass(item.status)">
                                                    {{ getStatusText(item.status) }}
                                                </span>
                                            </td>
                                            <td>{{ formatDate(item.created_at) }}</td>
                                            <td>
                                                <div class="btn-group btn-group-sm">
                                                    <button class="btn btn-outline-primary" 
                                                            @click="item.userType === 'agent' ? adjustAgentBalance(item) : adjustMemberBalance(item)">
                                                        <i class="fas fa-exchange-alt me-1"></i>ç‚¹æ•¸è½¬ç§»
                                                    </button>
                                                    <!-- ä»£ç†ç¨æœ‰ï¼šé€€æ°´è®¾å®š -->
                                                    <button v-if="item.userType === 'agent'" class="btn btn-outline-info" @click="showRebateSettingsModal(item)">
                                                        <i class="fas fa-percent me-1"></i>é€€æ°´è®¾å®š
                                                    </button>
                                                    <!-- ä»£ç†ç¨æœ‰ï¼šé™çº¢è®¾å®š -->
                                                    <button v-if="item.userType === 'agent'" class="btn btn-outline-warning" @click="adjustAgentBettingLimit(item)">
                                                        <i class="fas fa-sliders-h me-1"></i>é™çº¢è®¾å®š
                                                    </button>
                                                    <!-- ä¼šå‘˜ç¨æœ‰ï¼šè°ƒæ•´é™çº¢ -->
                                                    <button v-if="item.userType === 'member'" class="btn btn-outline-info" @click="adjustMemberBettingLimit(item)">
                                                        <i class="fas fa-sliders-h me-1"></i>è°ƒæ•´é™çº¢
                                                    </button>
                                                    <button class="btn btn-outline-warning" 
                                                            @click="item.userType === 'agent' ? resetAgentPassword(item) : resetMemberPassword(item)">
                                                        <i class="fas fa-key me-1"></i>é‡è¨­å¯†ç 
                                                    </button>
                                                    <div class="btn-group">
                                                        <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle" 
                                                                data-bs-toggle="dropdown" aria-expanded="false">
                                                            <i class="fas fa-cog me-1"></i>çŠ¶æ€
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li v-if="item.status !== 1">
                                                                <a class="dropdown-item" href="#" 
                                                                   @click.prevent="item.userType === 'agent' ? changeAgentStatus(item, 1) : changeMemberStatus(item, 1)">
                                                                    <i class="fas fa-check text-success me-2"></i>è¨­ä¸ºå¯ç”¨
                                                                </a>
                                                            </li>
                                                            <li v-if="item.status !== 0">
                                                                <a class="dropdown-item" href="#" 
                                                                   @click.prevent="item.userType === 'agent' ? changeAgentStatus(item, 0) : changeMemberStatus(item, 0)">
                                                                    <i class="fas fa-ban text-secondary me-2"></i>è¨­ä¸ºåœç”¨
                                                                </a>
                                                            </li>
                                                            <li v-if="item.status !== 2">
                                                                <a class="dropdown-item" href="#" 
                                                                   @click.prevent="item.userType === 'agent' ? changeAgentStatus(item, 2) : changeMemberStatus(item, 2)">
                                                                    <i class="fas fa-snowflake text-warning me-2"></i>è¨­ä¸ºå†»ç»“
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <button class="btn btn-outline-danger" 
                                                            @click="item.userType === 'agent' ? deleteAgent(item.id, item.username) : deleteMember(item.id, item.username)">
                                                        <i class="fas fa-trash-alt me-1"></i>åˆ é™¤
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div v-if="hierarchicalMembers.length === 0" class="text-center py-4">
                                <i class="fas fa-users-slash fa-3x text-muted mb-3"></i>
                                <p class="text-muted">ç›®å‰æ²’æœ‰ä¸‹ç´šå¸³è™Ÿ</p>
                                <div>
                                    <button class="btn btn-primary me-2" @click="quickCreateMember">
                                        <i class="fas fa-user-plus me-1"></i>æ–°å¢ä¼šå‘˜
                                    </button>
                                    <button v-if="(currentMemberManagingAgent ? currentMemberManagingAgent.level : (currentManagingAgent ? currentManagingAgent.level : user.level)) < 15" 
                                            class="btn btn-success" @click="showAgentModal">
                                        <i class="fas fa-plus me-1"></i>æ–°å¢ä»£ç†
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ–°å¢ä»£ç† Modal -->
                    <div class="modal" id="createAgentModal" tabindex="-1" v-if="showCreateAgentModal">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">æ–°å¢ä»£ç†</h5>
                                    <button type="button" class="btn-close" @click="hideCreateAgentModal"></button>
                                </div>
                                <div class="modal-body">
                                    <form @submit.prevent="createAgent">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ç”¨æˆ¶å</label>
                                                    <input type="text" class="form-control" v-model="newAgent.username" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">å¯†ç </label>
                                                    <input type="password" class="form-control" v-model="newAgent.password" required>
                                                </div>                                <div class="mb-3">
                                    <label class="form-label">ä»£ç†çº§åˆ«</label>
                                    <input type="text" class="form-control" 
                                           :value="getNextLevelName()" 
                                           readonly disabled>
                                    <small class="form-text text-muted">æ‚¨åªèƒ½åˆ›å»ºæ¯”ç›®å‰å±‚çº§ä½ä¸€ç´šçš„ä»£ç†</small>
                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ç›¤å£ç±»å‹</label>
                                                    <div class="form-control-plaintext bg-light border rounded p-2">
                                                        <i class="fas fa-info-circle text-info me-2"></i>
                                                        <strong>{{ getMarketInfo((currentMemberManagingAgent && currentMemberManagingAgent.market_type ? currentMemberManagingAgent.market_type : (currentManagingAgent.market_type || user.market_type)) || 'D').name }}</strong>
                                                        <small class="text-muted ms-2">({{ getMarketInfo((currentMemberManagingAgent && currentMemberManagingAgent.market_type ? currentMemberManagingAgent.market_type : (currentManagingAgent.market_type || user.market_type)) || 'D').description }})</small>
                                                    </div>
                                                    <small class="form-text text-muted">
                                                        <i class="fas fa-arrow-down me-1"></i>
                                                        ç›¤å£ç±»å‹è‡ªå‹•ç¹¼æ‰¿è‡ª {{ (currentMemberManagingAgent && currentMemberManagingAgent.username ? currentMemberManagingAgent.username : currentManagingAgent.username) }}ï¼Œç„¡éœ€é€‰æ‹©
                                                    </small>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">é™çº¢ç­‰çº§</label>
                                                    <select class="form-select" v-model="newAgent.betting_limit_level" required>
                                                        <option value="">è¯·é€‰æ‹©é™çº¢ç­‰çº§</option>
                                                        <option v-for="config in availableBettingLimitConfigs" 
                                                                :key="config.level_name" 
                                                                :value="config.level_name">
                                                            {{ config.level_display_name }} - {{ config.description }}
                                                        </option>
                                                    </select>
                                                    <small class="form-text text-muted">
                                                        <i class="fas fa-info-circle me-1"></i>
                                                        é™çº¢ç­‰çº§å†³å®šè©²ä»£ç†å¯åˆ›å»ºçš„ä¼šå‘˜å’Œä¸‹ç´šä»£ç†çš„æœ€é«˜é™çº¢ç­‰çº§
                                                    </small>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">é€€æ°´æ¨¡å¼</label>
                                                    <select class="form-select" v-model="newAgent.rebate_mode" required>
                                                        <option value="all">å…¨æ‹¿é€€æ°´ï¼ˆæœ¬ä»£ç†æ‹¿èµ°æ‰€æœ‰é€€æ°´ï¼‰</option>
                                                        <option value="percentage">æŒ‰æ¯”ä¾‹åˆ†é…ï¼ˆåˆ†é…çµ¦ä¸‹ç´šä»£ç†è®¾å®šæ¯”ä¾‹ï¼‰</option>
                                                        <option value="none">å…¨é€€ä¸‹ç´šï¼ˆæœ¬ä»£ç†ä¸æ‹¿ï¼Œå…¨çµ¦ä¸‹ç´šä»£ç†ï¼‰</option>
                                                    </select>
                                                    <small class="form-text text-muted">é€€æ°´åˆ†é…æ–¹å¼</small>
                                                </div>
                                                <div class="mb-3" v-if="newAgent.rebate_mode === 'percentage'">
                                                    <label class="form-label">é€€æ°´æ¯”ä¾‹ (%)</label>
                                                    <input type="number" class="form-control" v-model="newAgent.rebate_percentage" 
                                                           step="0.01" min="0" required>
                                                    <small class="form-text text-muted">
                                                        å¯è®¾å®šèŒƒå›´ï¼š0% - {{ (availableMaxRebatePercentage * 100).toFixed(1) }}% (ç›´å±¬ä¸Šç´šä»£ç†åˆ†é…é¢åº¦)
                                                    </small>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                                                    <textarea class="form-control" v-model="newAgent.notes" 
                                                              placeholder="è¯·è¾“å…¥ä»£ç†å¤‡æ³¨è¯´æ˜ï¼ˆé€‰å¡«ï¼‰" rows="3"></textarea>
                                                    <small class="form-text text-muted">å¯ç”¨æ–¼è®°å½•ä»£ç†çš„ç‰¹æ®Šæƒ…å†µã€è”ç³»æ–¹å¼ç­‰</small>
                                                </div>
                                                <div class="card bg-light">
                                                    <div class="card-header">
                                                        <h6 class="mb-0">é€€æ°´è¯´æ˜</h6>
                                                    </div>
                                                    <div class="card-body">
                                                        <ul class="mb-0 small">
                                                            <li><strong>å…¨æ‹¿æ‰€æœ‰é€€æ°´ï¼š</strong>è©²ä»£ç†è·å¾—æ‰€æœ‰å¯å¾—é€€æ°´ ({{ (availableMaxRebatePercentage * 100).toFixed(1) }}%)</li>
                                                            <li><strong>è®¾å®šå…·ä½“æ¯”ä¾‹ï¼š</strong>åˆ†é…çµ¦ä¸‹ç´šä»£ç†æŒ‡å®šæ¯”ä¾‹çš„é€€æ°´</li>
                                                            <li><strong>å…¨é€€çµ¦ä¸‹ç´šï¼š</strong>è©²ä»£ç†ä¸è·å¾—é€€æ°´ï¼Œå…¨éƒ¨çµ¦ä¸‹ç´šä»£ç†</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="hidden" v-model="newAgent.parent">

                                        <div class="text-end">
                                            <button type="button" class="btn btn-secondary me-2" @click="hideCreateAgentModal">å–æ¶ˆ</button>
                                            <button type="submit" class="btn btn-primary" :disabled="loading">
                                                <span v-if="loading" class="spinner-border spinner-border-sm" role="status"></span>
                                                å»ºç«‹
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- é€€æ°´è®¾å®š Modal -->
                    <div class="modal" id="rebateSettingsModal" tabindex="-1" v-if="showRebateModal">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">é€€æ°´è®¾å®š - {{ rebateAgent.username }}</h5>
                                    <button type="button" class="btn-close" @click="hideRebateSettingsModal"></button>
                                </div>
                                <div class="modal-body">
                                    <form @submit.prevent="updateRebateSettings">
                                        <div class="mb-3">
                                            <label class="form-label">é€€æ°´æ¨¡å¼</label>
                                            <select class="form-select" v-model="rebateSettings.rebate_mode" required>
                                                <option value="all">å…¨æ‹¿é€€æ°´</option>
                                                <option value="percentage">æŒ‰æ¯”ä¾‹åˆ†é…</option>
                                                <option value="none">å…¨é€€ä¸‹ç´š</option>
                                            </select>
                                        </div>
                                        <div class="mb-3" v-if="rebateSettings.rebate_mode === 'percentage'">
                                            <label class="form-label">é€€æ°´æ¯”ä¾‹ (%)</label>
                                            <input type="number" class="form-control" v-model="rebateSettings.rebate_percentage" 
                                                   step="0.01" min="0" required>
                                            <small class="form-text text-muted">
                                                å¯è®¾å®šèŒƒå›´ï¼š0% - {{ (availableMaxRebatePercentage * 100).toFixed(1) }}% (ç›´å±¬ä¸Šç´šä»£ç†åˆ†é…é¢åº¦)
                                            </small>
                                        </div>
                                        <div class="alert alert-info">
                                            <h6>ç›®å‰è®¾å®šï¼š</h6>
                                            <p class="mb-0">
                                                {{ getRebateModeText(rebateSettings.rebate_mode) }}
                                                {{ rebateSettings.rebate_mode === 'percentage' ? ` ${rebateSettings.rebate_percentage}%` : '' }}
                                            </p>
                                        </div>
                                        <div class="text-end">
                                            <button type="button" class="btn btn-secondary me-2" @click="hideRebateSettingsModal">å–æ¶ˆ</button>
                                            <button type="submit" class="btn btn-primary" :disabled="loading">
                                                <span v-if="loading" class="spinner-border spinner-border-sm" role="status"></span>
                                                æ›´æ–°
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ç¼–è¾‘ä»£ç†å¤‡æ³¨ Modal -->
                    <div class="modal fade" id="editAgentNotesModal" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">
                                        <i class="fas fa-sticky-note me-2 text-primary"></i>
                                        ç¼–è¾‘ä»£ç†å¤‡æ³¨ - {{ editNotesData.username }}
                                    </h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <form @submit.prevent="updateAgentNotes">
                                        <div class="mb-3">
                                            <label class="form-label">ä»£ç†èµ„è®¯</label>
                                            <div class="p-3 bg-light rounded">
                                                <div class="row">
                                                    <div class="col-6">
                                                        <strong>ä»£ç†ID:</strong> {{ editNotesData.id }}
                                                    </div>
                                                    <div class="col-6">
                                                        <strong>ç”¨æˆ¶å:</strong> {{ editNotesData.username }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                                            <textarea class="form-control" v-model="editNotesData.notes" 
                                                      placeholder="è¯·è¾“å…¥ä»£ç†å¤‡æ³¨è¯´æ˜" rows="5" 
                                                      style="resize: vertical;"></textarea>
                                            <small class="form-text text-muted">
                                                å¯ç”¨æ–¼è®°å½•ä»£ç†çš„ç‰¹æ®Šæƒ…å†µã€è”ç³»æ–¹å¼ã€é‡è¦æé†’ç­‰
                                            </small>
                                        </div>
                                        <div class="text-end">
                                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                            <button type="submit" class="btn btn-primary" :disabled="loading">
                                                <span v-if="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                                                <i v-else class="fas fa-save me-1"></i>
                                                {{ loading ? 'å„²å­˜ä¸­...' : 'å„²å­˜å¤‡æ³¨' }}
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>


                    
                    <!-- ç¼–è¾‘ä»£ç† Modal -->
                    <div class="modal" id="editAgentModal" tabindex="-1" v-if="showEditAgentModal">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">ç¼–è¾‘ä»£ç†</h5>
                                    <button type="button" class="btn-close" @click="hideEditAgentModal"></button>
                                </div>
                                <div class="modal-body">
                                    <form @submit.prevent="updateAgent">
                                        <div class="mb-3">
                                            <label class="form-label">ä»£ç†ID</label>
                                            <input type="text" class="form-control" v-model="editAgentData.id" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">ç”¨æˆ¶å</label>
                                            <input type="text" class="form-control" v-model="editAgentData.username" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">ä¿®æ”¹å¯†ç  (ç•™ç©ºè¡¨ç¤ºä¸ä¿®æ”¹)</label>
                                            <input type="password" class="form-control" v-model="editAgentData.password">
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">çŠ¶æ€</label>
                                            <select class="form-select" v-model="editAgentData.status">
                                                <option value="1">å¯ç”¨</option>
                                                <option value="0">åœç”¨</option>
                                                <option value="2">å†»ç»“</option>
                                            </select>
                                        </div>
                                        <div class="text-end">
                                            <button type="button" class="btn btn-secondary me-2" @click="hideEditAgentModal">å–æ¶ˆ</button>
                                            <button type="submit" class="btn btn-primary" :disabled="loading">
                                                <span v-if="loading" class="spinner-border spinner-border-sm" role="status"></span>
                                                æ›´æ–°
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å­å¸³è™Ÿç®¡ç†é¡µé¢ -->
                <div v-if="activeTab === 'subaccounts'">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>
                            <i class="fas fa-user-shield me-2"></i>å­å¸³è™Ÿç®¡ç†
                        </h2>
                        <button class="btn btn-primary" @click="openCreateSubAccountModal" :disabled="subAccounts.length >= 2">
                            <i class="fas fa-plus me-2"></i>æ–°å¢å­å¸³è™Ÿ
                        </button>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        æ¯ä¸ªä»£ç†æœ€å¤šå¯ä»¥åˆ›å»º 2 ä¸ªå­å¸³è™Ÿã€‚å­å¸³è™Ÿåªèƒ½æŸ¥çœ‹æŠ¥è¡¨ï¼Œç„¡æ³•è¿›è¡Œå…¶ä»–æ“ä½œã€‚
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>å­å¸³è™Ÿåç§°</th>
                                    <th>åˆ›å»ºæ—¶é—´</th>
                                    <th>æœ€åç™»å…¥æ—¶é—´</th>
                                    <th>çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="subAccount in subAccounts" :key="subAccount.id">
                                    <td>{{ subAccount.username }}</td>
                                    <td>{{ formatDate(subAccount.created_at) }}</td>
                                    <td>{{ subAccount.last_login ? formatDate(subAccount.last_login) : 'å¾æœªç™»å…¥' }}</td>
                                    <td>
                                        <span class="badge" :class="subAccount.status === 1 ? 'bg-success' : 'bg-danger'">
                                            {{ subAccount.status === 1 ? 'å¯ç”¨' : 'åœç”¨' }}
                                        </span>
                                    </td>
                                    <td>
                                        <button class="btn btn-sm btn-info me-2" @click="showResetPasswordModal(subAccount)">
                                            <i class="fas fa-key"></i> é‡è¨­å¯†ç 
                                        </button>
                                        <button class="btn btn-sm btn-warning me-2" @click="toggleSubAccountStatus(subAccount)">
                                            <i class="fas" :class="subAccount.status === 1 ? 'fa-ban' : 'fa-check'"></i>
                                            {{ subAccount.status === 1 ? 'åœç”¨' : 'å¯ç”¨' }}
                                        </button>
                                        <button class="btn btn-sm btn-danger" @click="deleteSubAccount(subAccount)">
                                            <i class="fas fa-trash"></i> åˆ é™¤
                                        </button>
                                    </td>
                                </tr>
                                <tr v-if="subAccounts.length === 0">
                                    <td colspan="5" class="text-center text-muted">å°šæœªåˆ›å»ºä»»ä½•å­å¸³è™Ÿ</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- æŠ¥è¡¨æŸ¥è¯¢é¡µé¢ -->
                <div v-if="activeTab === 'reports'">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>
                            <i class="fas fa-chart-bar me-2 text-primary"></i>æŠ¥è¡¨æŸ¥è¯¢
                        </h2>
                        <div class="d-flex gap-2">
                            <button class="btn btn-primary" @click="searchReports()">
                                <i class="fas fa-search me-1"></i>æŸ¥è¯¢
                            </button>
                        </div>
                    </div>

                    <!-- æŸ¥è¯¢æ¢ä»¶å€åŸŸ -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">
                                <i class="fas fa-filter me-2"></i>æŸ¥è¯¢æ¢ä»¶
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- ç¬¬ä¸€è¡Œï¼šæ—¶é—´èŒƒå›´ -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">æ—¶é—´èŒƒå›´</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fas fa-calendar-alt"></i>
                                        </span>
                                        <input type="date" class="form-control" v-model="reportFilters.startDate" placeholder="å¼€å§‹æ—¥æœŸ">
                                        <span class="input-group-text">è‡³</span>
                                        <input type="date" class="form-control" v-model="reportFilters.endDate" placeholder="ç»“æŸæ—¥æœŸ">
                                    </div>
                                    <small class="text-muted">é¢„è¨­æŸ¥è¯¢ä»Šæ—¥æŠ¥è¡¨ {{ getCurrentDateText() }}</small>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">å¿«é€ŸæŸ¥è¯¢</label>
                                    <div class="btn-group w-100" role="group">
                                        <button type="button" class="btn btn-outline-primary" @click="setDateRange('today')">ä»Šæ—¥</button>
                                        <button type="button" class="btn btn-outline-primary" @click="setDateRange('yesterday')">æ˜¨æ—¥</button>
                                        <button type="button" class="btn btn-outline-primary" @click="setDateRange('week')">æœ¬å‘¨</button>
                                        <button type="button" class="btn btn-outline-primary" @click="setDateRange('month')">æœ¬æœˆ</button>
                                    </div>
                                </div>
                            </div>

                            <!-- ç¬¬äºŒè¡Œï¼šéŠæˆ²ç±»å‹ç­›é€‰ -->
                            <div class="row mb-3">
                                <div class="col-md-12">
                                    <label class="form-label fw-bold">éŠæˆ²ç±»å‹</label>
                                    <div class="d-flex flex-wrap gap-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="gamePK10" v-model="reportFilters.gameTypes.pk10" checked disabled>
                                            <label class="form-check-label fw-bold" for="gamePK10">FSé‡‘å½©èµ›è½¦</label>
                                        </div>
                                    </div>
                                    <small class="text-muted">ç›®å‰åƒ…æ”¯æ´FSé‡‘å½©èµ›è½¦éŠæˆ²</small>
                                </div>
                            </div>

                            <!-- ç¬¬ä¸‰è¡Œï¼šç»“ç®—çŠ¶æ€å’Œç”¨æˆ¶ç­›é€‰ -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">ç»“ç®—çŠ¶æ€</label>
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="settlementStatus" id="statusAll" value="" v-model="reportFilters.settlementStatus">
                                            <label class="form-check-label" for="statusAll">å…¨éƒ¨</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="settlementStatus" id="statusSettled" value="settled" v-model="reportFilters.settlementStatus">
                                            <label class="form-check-label" for="statusSettled">å·²ç»“ç®—</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="settlementStatus" id="statusUnsettled" value="unsettled" v-model="reportFilters.settlementStatus">
                                            <label class="form-check-label" for="statusUnsettled">æœªç»“ç®—</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">ç”¨æˆ¶ç­›é€‰</label>
                                    <input type="text" class="form-control" v-model="reportFilters.username" placeholder="è¾“å…¥ä¼šå‘˜ç”¨æˆ¶åæˆ–ä»£ç†ç”¨æˆ¶å">
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- ä»£ç†å±‚çº§åˆ†ææŠ¥è¡¨ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="mb-0">
                                    <i class="fas fa-sitemap me-2"></i>ä»£ç†å±‚çº§åˆ†ææŠ¥è¡¨
                                </h5>
                                <div class="d-flex gap-2 align-items-center">
                                    <span v-if="reportData.agentInfo" class="badge bg-info d-flex align-items-center justify-content-center" style="height: 32px; padding: 8px 12px;">
                                        å…± {{ reportData.reportData ? reportData.reportData.length : 0 }} ä¸ªä¸‹ç´š
                                        ({{ reportData.agentInfo.agentCount || 0 }}ä»£ç† + {{ reportData.agentInfo.memberCount || 0 }}ä¼šå‘˜)
                                    </span>
                                    <span v-else class="badge bg-secondary d-flex align-items-center justify-content-center" style="height: 32px; padding: 8px 12px;">å…± {{ reportData.reportData ? reportData.reportData.length : 0 }} ä¸ªä¸‹ç´š</span>
                                    <button class="btn btn-sm btn-outline-primary" @click="refreshReportData()">
                                        <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                    </button>
                                </div>
                            </div>
                            
                            <!-- é¢åŒ…å±‘å°èˆª -->
                            <nav v-if="reportBreadcrumb.length > 0" aria-label="æŠ¥è¡¨å±‚çº§å°èˆª">
                                <ol class="breadcrumb mb-0 bg-light p-2 rounded">
                                    <li class="breadcrumb-item">
                                        <button class="btn btn-link p-0 text-decoration-none" @click="reportBreadcrumb = []; searchReports()">
                                            <i class="fas fa-home me-1"></i>æ ¹æŠ¥è¡¨
                                        </button>
                                    </li>
                                    <li v-for="(item, index) in reportBreadcrumb" :key="index" 
                                        class="breadcrumb-item"
                                        :class="{ 'active': index === reportBreadcrumb.length - 1 }">
                                        <span v-if="index === reportBreadcrumb.length - 1" class="fw-bold">
                                            {{ item.username }} ({{ getLevelName(item.level) }})
                                        </span>
                                        <button v-else class="btn btn-link p-0 text-decoration-none" 
                                                @click="reportBreadcrumb.splice(index + 1); goBackToLevel(item)">
                                            {{ item.username }} ({{ getLevelName(item.level) }})
                                        </button>
                                    </li>
                                    <li class="breadcrumb-item ms-auto">
                                        <button class="btn btn-sm btn-outline-secondary" @click="goBackToParentReport()">
                                            <i class="fas fa-arrow-left me-1"></i>è¿”å›ä¸Šç´š
                                        </button>
                                    </li>
                                </ol>
                            </nav>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive" style="font-size: 12px;">
                                <table class="table table-bordered table-sm">
                                    <thead>
                                        <!-- ç¬¬ä¸€è¡Œï¼šåˆ†çµ„æ ‡é¢˜ -->
                                        <tr style="background-color: #2c3e50;">
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">çº§åˆ«</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 120px;">ç”¨æˆ¶å</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">ä½™é¢</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 60px;">ç­†æ•¸</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">ä¸‹æ³¨é‡‘é¢</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">æœ‰æ•ˆé‡‘é¢</th>
                                            <th colspan="3" style="color: white; font-weight: bold; background-color: #34495e; text-align: center; border-bottom: 2px solid #95a5a6;">ä¼šå‘˜è¾“èµ¢</th>
                                            <th colspan="6" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; border-bottom: 2px solid #95a5a6;">{{ reportBreadcrumb.length > 0 ? getLevelName(reportBreadcrumb[reportBreadcrumb.length - 1].level) : getLevelName(user?.level) || 'æ€»ä»£ç†' }}</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">ä¸Šäº¤è´§é‡</th>
                                            <th rowspan="2" style="color: white; font-weight: bold; background-color: #2c3e50; text-align: center; vertical-align: middle; min-width: 80px;">ä¸Šç´šäº¤æ”¶</th>
                                        </tr>
                                        <!-- ç¬¬äºŒè¡Œï¼šç´°é¡¹æ ‡é¢˜ -->
                                        <tr style="background-color: #34495e;">
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">è¾“èµ¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 60px;">é€€æ°´</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">ç›ˆäºç»“æœ</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">æ‡‰æ”¶ä¸‹çº¿</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 50px;">ä½”æˆ</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">ä½”æˆé‡‘é¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">ä½”æˆç»“æœ</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 60px;">èµšæ°´</th>
                                            <th style="color: white; font-weight: bold; background-color: #34495e; text-align: center; min-width: 80px;">ç›ˆäºç»“æœ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- æ˜¾ç¤ºæ‰€æœ‰æœ‰ä¸‹æ³¨è®°å½•çš„ä»£ç†å’Œä¼šå‘˜ -->
                                        <template v-for="item in reportData.reportData.filter(item => item && (item.betCount > 0 || item.betAmount > 0))" :key="item.username">
                                            <!-- ä»£ç†è¡Œï¼ˆæœ‰ä¸‹ç´šå¯ç‚¹æ“Šï¼‰ -->
                                            <tr v-if="item.type === 'agent' || item.userType === 'agent'">
                                                <td class="text-center">
                                                    <span class="badge bg-primary">
                                                        <!-- å¦‚æœæ˜¯å½“å‰ç™»å½•çš„ä»£ç†ä¸”æ˜¯å­è´¦å·ï¼Œä½¿ç”¨user.levelè€Œä¸æ˜¯item.level -->
                                                        <template v-if="item.username === user.username && user.is_sub_account">
                                                            {{ parseInt(user.level) === 0 ? 'æ€»ä»£ç†' : getLevelShortName(parseInt(user.level)) + 'ä»£ç†' }}
                                                        </template>
                                                        <template v-else>
                                                            {{ parseInt(item.level) === 0 ? 'æ€»ä»£ç†' : getLevelShortName(parseInt(item.level)) + 'ä»£ç†' }}
                                                        </template>
                                                    </span>
                                                </td>
                                                <td class="text-center">
                                                    <div class="d-flex align-items-center justify-content-center">
                                                        <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                                                @click="enterAgentReport(item)">
                                                            {{ item.username }}
                                                            <i class="fas fa-chevron-right ms-1 small"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="text-end">{{ formatMoney(item.balance || 0) }}</td>
                                                <td class="text-center">{{ item.betCount || 0 }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)">{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)">{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)">{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-center">0%</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-center">{{ ((item.earnedRebatePercentage || 0) * 100).toFixed(1) }}%</td>
                                                <td class="text-end" :class="getProfitClass(item.earnedRebateAmount || 0)">{{ formatProfit(item.earnedRebateAmount || 0) }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass((item.memberWinLoss || 0) + (item.earnedRebateAmount || 0))">{{ formatProfit((item.memberWinLoss || 0) + (item.earnedRebateAmount || 0)) }}</td>
                                            </tr>
                                            <!-- ä¼šå‘˜è¡Œ -->
                                            <tr v-else-if="item.type === 'member' || item.userType === 'member'">
                                                <td class="text-center">
                                                    <span class="badge bg-success">ä¼šå‘˜</span>
                                                </td>
                                                <td class="text-center">
                                                    <div class="d-flex align-items-center justify-content-center">
                                                        <button class="btn btn-link p-0 text-decoration-none fw-bold text-success"
                                                                @click="showMemberBetRecords(item.username)">
                                                            {{ item.username }}
                                                            <i class="fas fa-external-link-alt ms-1 small"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="text-end">{{ formatMoney(item.balance || 0) }}</td>
                                                <td class="text-center">{{ item.betCount || 0 }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)" >{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)">{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass(item.memberWinLoss)">{{ formatProfit(item.memberWinLoss || 0) }}</td>
                                                <td class="text-center">0%</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-end">0.00</td>
                                                <td class="text-center">{{ ((item.earnedRebatePercentage || 0) * 100).toFixed(1) }}%</td>
                                                <td class="text-end" :class="getProfitClass(item.earnedRebateAmount || 0)">{{ formatProfit(item.earnedRebateAmount || 0) }}</td>
                                                <td class="text-end">{{ formatMoney(item.betAmount || 0) }}</td>
                                                <td class="text-end" :class="getProfitClass((item.memberWinLoss || 0) + (item.earnedRebateAmount || 0))">{{ formatProfit((item.memberWinLoss || 0) + (item.earnedRebateAmount || 0)) }}</td>
                                            </tr>
                                        </template>
                                        <!-- æ€»è®¡è¡Œ -->
                                        <tr v-if="reportData.reportData && reportData.reportData.filter(item => item && (item.betCount > 0 || item.betAmount > 0)).length > 0" class="fw-bold" style="background-color: #e8f5e9; border-top: 2px solid #4caf50;">
                                            <td class="text-center" colspan="2">æ€»è®¡</td>
                                            <td class="text-center">-</td>
                                            <td class="text-center">{{ reportData.totalSummary.betCount || 0 }}</td>
                                            <td class="text-end">{{ formatMoney(reportData.totalSummary.betAmount || 0) }}</td>
                                            <td class="text-end">{{ formatMoney(reportData.totalSummary.betAmount || 0) }}</td>
                                            <td class="text-end" :class="getProfitClass(reportData.totalSummary.memberWinLoss)">{{ formatProfit(reportData.totalSummary.memberWinLoss || 0) }}</td>
                                            <td class="text-end">0.00</td>
                                            <td class="text-end" :class="getProfitClass(reportData.totalSummary.memberWinLoss)">{{ formatProfit(reportData.totalSummary.memberWinLoss || 0) }}</td>
                                            <td class="text-end" :class="getProfitClass(reportData.totalSummary.memberWinLoss)">{{ formatProfit(reportData.totalSummary.memberWinLoss || 0) }}</td>
                                            <td class="text-center">0%</td>
                                            <td class="text-end">0.00</td>
                                            <td class="text-end">0.00</td>
                                            <td class="text-end">{{ formatMoney(reportData.totalSummary.earnedRebateAmount || 0) }}</td>
                                            <td class="text-end fw-bold" :class="getProfitClass(reportData.totalSummary.earnedRebateAmount || 0)">{{ formatProfit(reportData.totalSummary.earnedRebateAmount || 0) }}</td>
                                            <td class="text-end">{{ formatMoney(reportData.totalSummary.betAmount || 0) }}</td>
                                            <td class="text-end fw-bold" :class="getProfitClass((reportData.totalSummary.memberWinLoss || 0) + (reportData.totalSummary.earnedRebateAmount || 0))">{{ formatProfit((reportData.totalSummary.memberWinLoss || 0) + (reportData.totalSummary.earnedRebateAmount || 0)) }}</td>
                                        </tr>
                                        <tr v-if="loading">
                                            <td colspan="17" class="text-center text-muted py-4">
                                                <i class="fas fa-spinner fa-spin fa-2x mb-2 d-block"></i>
                                                è½½å…¥ä¸­...
                                            </td>
                                        </tr>
                                        <tr v-else-if="!reportData.reportData || reportData.reportData.filter(item => item && (item.betCount > 0 || item.betAmount > 0)).length === 0">
                                            <td colspan="17" class="text-center text-muted py-4">
                                                <i class="fas fa-inbox fa-2x mb-2 d-block"></i>
                                                æ²’æœ‰æœ‰æ•ˆä¸‹æ³¨èµ„æ–™
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- æŠ¥è¡¨è¯´æ˜ -->
                            <div class="mt-3 p-3 bg-light rounded">
                                <h6 class="mb-2"><i class="fas fa-info-circle me-2"></i>æŠ¥è¡¨è¯´æ˜</h6>
                                <div class="row small text-muted">
                                    <div class="col-md-4">
                                        <ul class="mb-0">
                                            <li><strong>æ™ºèƒ½æ˜¾ç¤º:</strong> åªæ˜¾ç¤ºæœ‰ä¸‹æ³¨è®°å½•çš„ä»£ç†å’Œä¼šå‘˜</li>
                                            <li><strong>ä»£ç†:</strong> æœ‰è—è‰²æ¨™ç±¤ï¼Œå¯ç‚¹æ“Šè¿›å…¥ä¸‹ç´š</li>
                                            <li><strong>ä¼šå‘˜:</strong> æœ‰ç¶ è‰²æ¨™ç±¤ï¼Œç›´æ¥ç»Ÿè®¡æŠ•æ³¨</li>
                                            <li><strong>ä¼šå‘˜è¾“èµ¢:</strong> ä¼šå‘˜çš„ç›ˆäºçŠ¶å†µ</li>
                                            <li><strong>é€€æ°´:</strong> ä¼šå‘˜é€€æ°´é‡‘é¢</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-4">
                                        <ul class="mb-0">
                                            <li><strong>ç›ˆäºç»“æœ:</strong> ä»£ç†çš„å¯¦é™…ç›ˆäº</li>
                                            <li><strong>å¯¦ä½”é€€æ°´:</strong> é€€æ°´åˆ†é…ç™¾åˆ†æ¯”</li>
                                            <li><strong>èµšæ°´:</strong> é€€æ°´åˆ©æ¶¦</li>
                                            <li><strong>ç›ˆäºç»“æœ:</strong> æœ€çµ‚ç›ˆäºï¼ˆå«é€€æ°´ï¼‰</li>
                                            <li><strong>å±‚çº§é’»å–:</strong> ç‚¹æ“Šä»£ç†åç§°æŸ¥çœ‹å…¶ä¸‹ç´š</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-4">
                                        <ul class="mb-0">
                                            <li><strong>ç°¡åŒ–é€»è¾‘:</strong> ä¸åˆ†æœ¬ç´šä¸‹ç´šï¼Œçµ±ä¸€æ˜¾ç¤º</li>
                                            <li><strong>æ€»è®¡è®¡ç®—:</strong> æ‰€æœ‰ç›´æ¥ä¸‹ç´šçš„åŠ ç¸½</li>
                                            <li><strong>æ¸…æ™°å±‚çº§:</strong> æ¯ä¸ªä»£ç†çœ‹åˆ°è‡ªå·±åˆ›å»ºçš„äººå“¡</li>
                                            <li><strong>æ­£ç¢ºç»Ÿè®¡:</strong> æ€»è®¡å°±æ˜¯å¯¦é™…æ¥­ç¸¾</li>
                                            <li><strong>ç„¡é‡å¤è®¡ç®—:</strong> æ¯ç­†æ•°æ®åªè®¡ç®—ä¸€æ¬¡</li>
                                            <li><strong>ä¼šå‘˜ä¸‹æ³¨:</strong> ç‚¹æ“Šä¼šå‘˜ç”¨æˆ¶åæŸ¥çœ‹è¯¦ç»†ä¸‹æ³¨è®°å½•</li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä¼šå‘˜ä¸‹æ³¨è®°å½•è¦–çª— -->
                <div v-if="memberBetRecords.isVisible" class="modal d-block" style="background-color: rgba(0,0,0,0.5);">
                    <div class="modal-dialog modal-xl" style="max-width: 95%; margin: 30px auto;">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-list-alt me-2"></i>
                                    {{ memberBetRecords.memberUsername }} çš„ä¸‹æ³¨è®°å½•
                                </h5>
                                <button type="button" class="btn-close btn-close-white" @click="closeMemberBetRecords()"></button>
                            </div>
                            <div class="modal-body">

                                <!-- ä¸‹æ³¨è®°å½•è¡¨æ ¼ -->
                                <div class="table-responsive" style="max-height: 70vh; overflow-y: auto;">
                                    <table class="table table-striped table-hover" style="font-size: 14px; width: 100%;">
                                        <thead class="sticky-top" style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                            <tr>
                                                <th style="min-width: 120px; color: white; font-weight: bold; background-color: #1e3a8a;">å•å·</th>
                                                <th style="min-width: 130px; color: white; font-weight: bold; background-color: #1e3a8a;">æŠ•æ³¨æ—¶é—´</th>
                                                <th style="min-width: 100px; color: white; font-weight: bold; background-color: #1e3a8a;">éŠæˆ²</th>
                                                <th style="min-width: 80px; color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                                <th style="min-width: 150px; color: white; font-weight: bold; background-color: #1e3a8a;">æŠ•æ³¨å†…å®¹</th>
                                                <th style="min-width: 80px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">ä¸‹æ³¨é‡‘é¢</th>
                                                <th style="min-width: 60px; color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´</th>
                                                <th style="min-width: 80px; color: white; font-weight: bold; background-color: #1e3a8a;">ä¸‹æ³¨ç»“æœ</th>
                                                <th style="min-width: 90px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">æœ¬ç´šä½”æˆ</th>
                                                <th style="min-width: 80px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">æœ¬ç´šç»“æœ</th>
                                                <th style="min-width: 80px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">ä½”æˆæ˜ç»†</th>
                                                <th style="min-width: 100px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">å¼€å¥–ç»“æœ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-if="memberBetRecords.loading">
                                                <td colspan="12" class="text-center py-4">
                                                    <i class="fas fa-spinner fa-spin"></i> è½½å…¥ä¸­...
                                                </td>
                                            </tr>
                                            <tr v-else-if="memberBetRecords.records.length === 0">
                                                <td colspan="12" class="text-center py-4 text-muted">
                                                    <i class="fas fa-inbox"></i> æŸ¥è¯¢æœŸé—´å…§ç„¡ä¸‹æ³¨è®°å½•
                                                </td>
                                            </tr>
                                            <template v-else v-for="record in memberBetRecords.records" :key="record.id">
                                                <tr>
                                                    <td>{{ record.bet_id || record.id || 'BET' + new Date().getTime() }}</td>
                                                    <td>{{ formatBetTimeDetailed(record.created_at) }}</td>
                                                    <td>FSé‡‘å½©èµ›è½¦<br><small class="text-muted">{{ record.period_number || record.period || '20250708001' }}æœŸ</small></td>
                                                    <td>{{ record.username }}<br><small class="text-muted">{{ formatMarketType(record.market_type) }}</small></td>
                                                    <td>
                                                        <div>
                                                            <span style="color: #28a745; font-weight: bold;">{{ formatBetPosition(record) }}</span>
                                                        </div>
                                                        <div>
                                                            <span style="color: #000;">@</span>
                                                            <span style="color: #dc3545; font-weight: bold;">{{ formatOddsByMarket(record) }}</span>
                                                        </div>
                                                    </td>
                                                    <td class="text-end">{{ formatMoney(record.bet_amount) }}</td>
                                                    <td class="text-center">0.0%</td>
                                                    <td class="text-center">
                                                        <span :class="getBetResultDetailedClass(record)">{{ formatBetResultDetailed(record) }}</span>
                                                    </td>
                                                    <td class="text-center" style="white-space: nowrap;">{{ formatPercentage(record.commission_rate) }}</td>
                                                    <td class="text-end">{{ formatAgentRebate(record) }}</td>
                                                    <td class="text-center" style="white-space: nowrap;">
                                                        <button class="btn btn-outline-info btn-sm" @click="showCommissionDetails(record)" :disabled="!record.commission_details">
                                                            æ˜ç»†
                                                        </button>
                                                    </td>
                                                    <td class="text-center" style="white-space: nowrap;">
                                                        <button class="btn btn-outline-primary btn-sm" 
                                                                @click="safeToggleDrawResult(record)"
                                                                :disabled="!record.id || !record.period_number">
                                                            <i class="fas" :class="record.id && record.period_number && memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`] ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
                                                            å¼€å¥–ç»“æœ
                                                        </button>
                                                    </td>
                                                </tr>
                                                <!-- å±•å¼€çš„å¼€å¥–ç»“æœè¡Œ -->
                                                <tr v-if="record.id && record.period_number && memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`]">
                                                    <td colspan="12" class="p-0">
                                                        <div class="bg-light border-top p-3">
                                                            <div v-if="record.id && record.period_number && memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].loading" 
                                                                 class="text-center">
                                                                <i class="fas fa-spinner fa-spin"></i> è½½å…¥å¼€å¥–ç»“æœä¸­...
                                                            </div>
                                                            <div v-else-if="record.id && record.period_number && memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].error" 
                                                                 class="text-center text-danger">
                                                                <i class="fas fa-exclamation-triangle me-2"></i>{{ memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].message }}
                                                            </div>
                                                            <div v-else-if="record.id && record.period_number && memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].numbers" class="row">
                                                                <div class="col-md-6">
                                                                    <h6 class="mb-2">{{ record.period_number }}æœŸå¼€å¥–ç»“æœ</h6>
                                                                    <div class="d-flex flex-wrap gap-2">
                                                                        <span v-for="(number, index) in memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].numbers" 
                                                                              :key="index" 
                                                                              :class="getNumberBadgeClass(number, index)">
                                                                            {{ number }}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <div class="text-muted small">
                                                                        å¼€å¥–æ—¶é—´ï¼š{{ formatBetTime(memberBetRecords.expandedRecords[`${record.id}_${record.period_number}`].drawTime) }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div v-else class="text-danger text-center">
                                                                èµ„æ–™ä¸å®Œæ•´ï¼Œç„¡æ³•æ˜¾ç¤ºå¼€å¥–ç»“æœ
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- åˆ†é¡µ -->
                                <div v-if="memberBetRecords.pagination.totalPages > 1" class="d-flex justify-content-center mt-3">
                                    <nav aria-label="ä¸‹æ³¨è®°å½•åˆ†é¡µ">
                                        <ul class="pagination">
                                            <li class="page-item" :class="{ disabled: memberBetRecords.pagination.page <= 1 }">
                                                <button class="page-link" @click="changeMemberBetPage(memberBetRecords.pagination.page - 1)">
                                                    <i class="fas fa-chevron-left"></i> ä¸Šä¸€é¡µ
                                                </button>
                                            </li>
                                            <li v-for="page in getMemberBetPageRange()" :key="page" 
                                                class="page-item" :class="{ active: page === memberBetRecords.pagination.page }">
                                                <button class="page-link" @click="changeMemberBetPage(page)">{{ page }}</button>
                                            </li>
                                            <li class="page-item" :class="{ disabled: memberBetRecords.pagination.page >= memberBetRecords.pagination.totalPages }">
                                                <button class="page-link" @click="changeMemberBetPage(memberBetRecords.pagination.page + 1)">
                                                    ä¸‹ä¸€é¡µ <i class="fas fa-chevron-right"></i>
                                                </button>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä½”æˆæ˜ç»†è¦–çª— -->
                <div v-if="commissionDetails.isVisible" class="modal d-block" style="background-color: rgba(0,0,0,0.5);">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-info text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-chart-pie me-2"></i>ä½”æˆæ˜ç»†({{ commissionDetails.betRecord ? (commissionDetails.betRecord.bet_id || commissionDetails.betRecord.id) : '' }})
                                </h5>
                                <button type="button" class="btn-close btn-close-white" @click="closeCommissionDetails()"></button>
                            </div>
                            <div class="modal-body">
                                <div v-if="commissionDetails.betRecord" class="mb-3">
                                    <p><strong>å•å·ï¼š</strong>{{ commissionDetails.betRecord.bet_id || commissionDetails.betRecord.id }}</p>
                                    <p><strong>æŠ•æ³¨é‡‘é¢ï¼š</strong>{{ formatMoney(commissionDetails.betRecord.bet_amount) }}</p>
                                </div>
                                <table class="table table-sm">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç±»å‹</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                            <th class="text-center" style="color: white; font-weight: bold; background-color: #1e3a8a;">ä½”æˆ</th>
                                            <th class="text-center" style="color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="commissionDetails.details.length === 0">
                                            <td colspan="4" class="text-center text-muted">è©²ä¼šå‘˜ç„¡ä¸Šç´šä»£ç†é“¾ï¼Œæš«ç„¡ä½”æˆèµ„æ–™</td>
                                        </tr>
                                        <tr v-for="detail in commissionDetails.details" :key="detail.id">
                                            <td>{{ detail.agent_type }}</td>
                                            <td>{{ detail.username }}</td>
                                            <td class="text-center">{{ formatPercentage(detail.commission_rate) }}</td>
                                            <td class="text-center">{{ formatPercentage(detail.rebate_rate) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¼€å¥–ç»“æœè¦–çª— -->
                <div v-if="drawResultModal.isVisible" class="modal d-block" style="background-color: rgba(0,0,0,0.5);">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-warning text-dark">
                                <h5 class="modal-title">
                                    <i class="fas fa-trophy me-2"></i>å¼€å¥–ç»“æœ
                                </h5>
                                <button type="button" class="btn-close" @click="closeDrawResult()"></button>
                            </div>
                            <div class="modal-body">
                                <div v-if="drawResultModal.loading" class="text-center py-4">
                                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                                    <p class="mt-2">æŸ¥è¯¢å¼€å¥–ç»“æœä¸­...</p>
                                </div>
                                <div v-else>
                                    <div class="mb-3">
                                        <p><strong>éŠæˆ²ï¼š</strong>{{ formatGameTypeDisplay(drawResultModal.gameType) }}</p>
                                        <p><strong>æœŸè™Ÿï¼š</strong>{{ drawResultModal.periodNumber }}æœŸ</p>
                                        <p v-if="drawResultModal.drawTime"><strong>å¼€å¥–æ—¶é—´ï¼š</strong>{{ formatBetTime(drawResultModal.drawTime) }}</p>
                                    </div>
                                    <div v-if="drawResultModal.resultNumbers" class="text-center">
                                        <h6>å¼€å¥–å·ç ï¼š</h6>
                                        <div class="d-flex justify-content-center gap-2 flex-wrap">
                                            <span v-for="(number, index) in drawResultModal.resultNumbers" :key="index" 
                                                  class="badge bg-primary fs-6 py-2 px-3">
                                                {{ number }}
                                            </span>
                                        </div>
                                    </div>
                                    <div v-else class="text-center text-muted">
                                        <i class="fas fa-question-circle"></i>
                                        <p>æš«ç„¡å¼€å¥–ç»“æœ</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- äº‹å‹™è®°å½•é¡µé¢ -->
                <div v-if="activeTab === 'transactions'">
                    <h2>äº¤æ˜“è®°å½•</h2>
                    
                    <ul class="nav nav-tabs mb-3">
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: transactionTab === 'deposit'}" href="#" @click="transactionTab = 'deposit'; loadDepositRecords()">
                                <i class="fas fa-credit-card me-1"></i>å­˜æ¬¾è®°å½•
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: transactionTab === 'withdraw'}" href="#" @click="transactionTab = 'withdraw'; loadWithdrawRecords()">
                                <i class="fas fa-money-bill-wave me-1"></i>ææ¬¾è®°å½•
                            </a>
                        </li>
                        <!-- é€€æ°´è¨˜éŒ„åŠŸèƒ½æš«æ™‚éš±è—
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: transactionTab === 'rebate'}" href="#" @click="transactionTab = 'rebate'; loadRebateRecords()">
                                <i class="fas fa-gift me-1"></i>é€€æ°´è®°å½•
                            </a>
                        </li>
                        -->
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: transactionTab === 'transfers'}" href="#" @click="loadPointTransfers(); transactionTab = 'transfers'">
                                <i class="fas fa-exchange-alt me-1"></i>ç‚¹æ•°è½¬ç§»è®°å½•
                            </a>
                        </li>
                    </ul>
                    
                    <!-- å­˜æ¬¾è®°å½• -->
                    <div v-if="transactionTab === 'deposit'" class="card">
                        <div class="card-header">
                            å­˜æ¬¾è®°å½•
                            <div class="float-end">
                                <button class="btn btn-sm btn-outline-primary" @click="loadDepositRecords()">
                                    <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç·¨å·</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶ç±»å‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶åç§°</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">äº¤æ˜“ç±»å‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">é‡‘é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå‰ä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå¾Œä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è¯´æ˜</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody>                                        <tr v-for="record in depositRecords" :key="record.id">
                            <td>{{ record.id }}</td>
                            <td>{{ formatUserType(record.user_type) }}</td>
                            <td>{{ record.username || 'æœªçŸ¥ç”¨æˆ¶' }}</td>
                            <td>
                                <span class="badge bg-success">{{ formatTransactionType(record) }}</span>
                                            </td>
                                            <td class="text-success">+{{ formatMoney(Math.abs(record.amount)) }}</td>
                                            <td>{{ formatMoney(record.before_balance) }}</td>
                                            <td>{{ formatMoney(record.after_balance) }}</td>
                                            <td>{{ record.description || '-' }}</td>
                                            <td>{{ formatDate(record.created_at) }}</td>
                                        </tr>
                                        <tr v-if="depositRecords.length === 0">
                                            <td colspan="9" class="text-center">ç„¡å­˜æ¬¾è®°å½•</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ææ¬¾è®°å½• -->
                    <div v-if="transactionTab === 'withdraw'" class="card">
                        <div class="card-header">
                            ææ¬¾è®°å½•
                            <div class="float-end">
                                <button class="btn btn-sm btn-outline-primary" @click="loadWithdrawRecords()">
                                    <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç·¨å·</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶ç±»å‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶åç§°</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">äº¤æ˜“ç±»å‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">é‡‘é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå‰ä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå¾Œä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è¯´æ˜</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="record in withdrawRecords" :key="record.id">
                                            <td>{{ record.id }}</td>
                                            <td>{{ formatUserType(record.user_type) }}</td>
                                            <td>{{ record.username || 'æœªçŸ¥ç”¨æˆ¶' }}</td>
                                            <td>
                                                <span class="badge bg-danger">{{ formatTransactionType(record) }}</span>
                                            </td>
                                            <td class="text-danger">{{ formatMoney(record.amount) }}</td>
                                            <td>{{ formatMoney(record.before_balance) }}</td>
                                            <td>{{ formatMoney(record.after_balance) }}</td>
                                            <td>{{ record.description || '-' }}</td>
                                            <td>{{ formatDate(record.created_at) }}</td>
                                        </tr>
                                        <tr v-if="withdrawRecords.length === 0">
                                            <td colspan="9" class="text-center">ç„¡ææ¬¾è®°å½•</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- é€€æ°´è¨˜éŒ„åŠŸèƒ½æš«æ™‚éš±è—
                    <div v-if="transactionTab === 'rebate'" class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-gift me-2 text-warning"></i>é€€æ°´è®°å½•
                                    <span class="badge bg-warning text-dark ms-2">{{ rebateRecords.length }}</span>
                                </div>
                                <div>
                                    <button class="btn btn-sm btn-outline-warning me-2" @click="loadRebateRecords()">
                                        <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                    </button>
                                    <span class="text-muted small">
                                        ç¸½é€€æ°´: <span class="fw-bold text-warning">{{ formatMoney(totalRebateAmount) }}</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">ä¼šå‘˜</span>
                                        <input type="text" class="form-control" placeholder="è¾“å…¥ä¼šå‘˜åç§°" v-model="rebateFilters.member">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">æ—¥æœŸ</span>
                                        <input type="date" class="form-control" v-model="rebateFilters.date">
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-sm btn-warning w-100" @click="filterRebateRecords">
                                        <i class="fas fa-filter me-1"></i>ç­›é€‰
                                    </button>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-sm btn-outline-secondary w-100" @click="clearRebateFilters">
                                        <i class="fas fa-times me-1"></i>æ¸…é™¤
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç·¨å·</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ä¼šå‘˜åç§°</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ä¸‹æ³¨é‡‘é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´æ¯”ä¾‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´é‡‘é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå‰ä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå¾Œä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æœŸæ•°</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="record in filteredRebateRecords" :key="record.id" class="align-middle">
                                            <td>
                                                <span class="badge bg-warning text-dark">{{ record.id }}</span>
                                            </td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <i class="fas fa-user me-2 text-muted"></i>
                                                    <strong>{{ record.member_username || 'æœªçŸ¥ä¼šå‘˜' }}</strong>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="text-primary fw-bold">{{ formatMoney(record.bet_amount) }}</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-info">{{ (record.rebate_percentage * 100).toFixed(1) }}%</span>
                                            </td>
                                            <td>
                                                <span class="text-success fw-bold">+{{ formatMoney(record.amount) }}</span>
                                            </td>
                                            <td>{{ formatMoney(record.before_balance) }}</td>
                                            <td>{{ formatMoney(record.after_balance) }}</td>
                                            <td>
                                                <span class="badge bg-secondary">{{ record.period || '-' }}</span>
                                            </td>
                                            <td>
                                                <small class="text-muted">{{ formatDate(record.created_at) }}</small>
                                            </td>
                                        </tr>
                                        <tr v-if="filteredRebateRecords.length === 0">
                                            <td colspan="9" class="text-center py-4">
                                                <div class="text-muted">
                                                    <i class="fas fa-inbox fa-2x mb-2"></i>
                                                    <p>{{ rebateRecords.length === 0 ? 'å°šç„¡é€€æ°´è®°å½•' : 'æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è®°å½•' }}</p>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div v-if="rebateRecords.length > 0" class="border-top pt-3 mt-3">
                                <div class="row text-center">
                                    <div class="col-md-3">
                                        <div class="p-2 bg-light rounded">
                                            <div class="text-muted small">ç¸½ç­†æ•¸</div>
                                            <div class="fw-bold text-primary">{{ filteredRebateRecords.length }}</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="p-2 bg-light rounded">
                                            <div class="text-muted small">ç¸½ä¸‹æ³¨é‡‘é¢</div>
                                            <div class="fw-bold text-info">{{ formatMoney(totalFilteredBetAmount) }}</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="p-2 bg-light rounded">
                                            <div class="text-muted small">ç¸½é€€æ°´é‡‘é¢</div>
                                            <div class="fw-bold text-success">{{ formatMoney(totalFilteredRebateAmount) }}</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="p-2 bg-light rounded">
                                            <div class="text-muted small">å¹³å‡é€€æ°´æ¯”ä¾‹</div>
                                            <div class="fw-bold text-warning">{{ averageRebatePercentage }}%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    -->

                    <!-- ç‚¹æ•°è½¬ç§»è®°å½• -->
                    <div v-if="transactionTab === 'transfers'" class="card">
                        <div class="card-header">
                            ç‚¹æ•°è½¬ç§»è®°å½•
                            <div class="float-end">
                                <button class="btn btn-sm btn-outline-primary" @click="loadPointTransfers()">
                                    <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç·¨å·</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">ç±»å‹</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è½¬ç§»æ–¹å‘</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">é‡‘é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è½¬å‡ºå‰ä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è½¬å‡ºå¾Œä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è½¬å…¥å‰ä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è½¬å…¥å¾Œä½™é¢</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">è¯´æ˜</th>
                                            <th scope="col" style="color: white; font-weight: bold; background-color: #1e3a8a;">æ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="transfer in pointTransfers" :key="transfer.id">
                                            <td>{{ transfer.id }}</td>
                                            <td>{{ formatTransferType(transfer) }}</td>
                                            <td>{{ formatTransferDirection(transfer) }}</td>
                                            <td>{{ formatMoney(transfer.amount) }}</td>
                                            <td>{{ formatMoney(transfer.from_before_balance) }}</td>
                                            <td>{{ formatMoney(transfer.from_after_balance) }}</td>
                                            <td>{{ formatMoney(transfer.to_before_balance) }}</td>
                                            <td>{{ formatMoney(transfer.to_after_balance) }}</td>
                                            <td>{{ transfer.description || '-' }}</td>
                                            <td>{{ formatDate(transfer.created_at) }}</td>
                                        </tr>
                                        <tr v-if="pointTransfers.length === 0">
                                            <td colspan="10" class="text-center">ç„¡ç‚¹æ•°è½¬ç§»è®°å½•</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ... other transaction tabs ... -->
                </div>

                <!-- å¼€å¥–è®°å½• -->
                <div v-if="activeTab === 'draw'">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>å¼€å¥–è®°å½•</h2>
                        <button class="btn btn-primary" @click="loadDrawHistory">
                            <i class="fas fa-sync-alt me-1"></i>åˆ·æ–°
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="row g-2">
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <span class="input-group-text">æœŸæ•°</span>
                                        <input type="text" class="form-control" placeholder="è¾“å…¥æœŸæ•°æŸ¥è¯¢" v-model="drawFilters.period">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <span class="input-group-text">æ—¥æœŸ</span>
                                        <input type="date" class="form-control" v-model="drawFilters.date">
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-primary w-100" @click="searchDrawHistory">
                                        <i class="fas fa-search me-1"></i>æœç´¢
                                    </button>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-secondary w-100" @click="searchTodayDrawHistory">
                                        <i class="fas fa-calendar-day me-1"></i>ä»Šæ—¥å¼€å¥–
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æœŸæ•°</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å¼€å¥–å·ç </th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å¼€å¥–æ—¶é—´</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å† äºšå†›</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">é¾™è™</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="record in drawRecords" :key="record.period">
                                            <td>{{ record.period }}</td>
                                            <td>
                                                <div class="d-flex">
                                                    <span v-for="(num, index) in record.result || []" :key="index"
                                                          class="number-ball mx-1"
                                                          :class="'color-' + num">
                                                        {{ num || '-' }}
                                                    </span>
                                                </div>
                                            </td>
                                            <td>{{ record.draw_time ? formatDate(record.draw_time) : 'N/A' }}</td>
                                            <td v-if="record && record.result && record.result.length >= 2">
                                                <div>å† : {{ record.result[0] > 5 ? 'å¤§' : 'å°' }} {{ record.result[0] % 2 === 0 ? 'åŒ' : 'å–®' }}</div>
                                                <div>äº: {{ record.result[1] > 5 ? 'å¤§' : 'å°' }} {{ record.result[1] % 2 === 0 ? 'åŒ' : 'å–®' }}</div>
                                            </td>
                                            <td v-else><span>-</span></td>
                                            <td>
                                                <span v-if="record && record.result && record.result.length >= 10" 
                                                      :class="{'text-danger': record.result[0] > record.result[9], 'text-primary': record.result[0] < record.result[9]}">
                                                    {{ getDragonTigerResult(record).value }}
                                                </span>
                                                <span v-else>-</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <!-- ç„¡è®°å½•æ˜¾ç¤º -->
                                <div v-if="drawRecords.length === 0" class="text-center py-4">
                                    <p class="text-muted">æš«ç„¡å¼€å¥–è®°å½•</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- åˆ†é¡µæ§åˆ¶ -->
                        <div class="card-footer">
                            <nav v-if="drawPagination.totalPages > 1">
                                <ul class="pagination justify-content-center mb-0">
                                    <li class="page-item" :class="{disabled: drawPagination.currentPage === 1}">
                                        <a class="page-link" href="#" @click.prevent="changePage(1, 'draw')">é¦–é¡µ</a>
                                    </li>
                                    <li class="page-item" :class="{disabled: drawPagination.currentPage === 1}">
                                        <a class="page-link" href="#" @click.prevent="changePage(drawPagination.currentPage - 1, 'draw')">ä¸Šä¸€é¡µ</a>
                                    </li>
                                    
                                    <li v-for="page in getPageRange(drawPagination.currentPage, drawPagination.totalPages)" 
                                        :key="page" 
                                        class="page-item" 
                                        :class="{active: page === drawPagination.currentPage}">
                                        <a class="page-link" href="#" @click.prevent="changePage(page, 'draw')">{{ page }}</a>
                                    </li>
                                    
                                    <li class="page-item" :class="{disabled: drawPagination.currentPage === drawPagination.totalPages}">
                                        <a class="page-link" href="#" @click.prevent="changePage(drawPagination.currentPage + 1, 'draw')">ä¸‹ä¸€é¡µ</a>
                                    </li>
                                    <li class="page-item" :class="{disabled: drawPagination.currentPage === drawPagination.totalPages}">
                                        <a class="page-link" href="#" @click.prevent="changePage(drawPagination.totalPages, 'draw')">æœ«é¡µ</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>



                <!-- ç³»ç»Ÿå…¬å‘Š -->
                <div v-if="activeTab === 'notices'">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>ç³»ç»Ÿå…¬å‘Š</h2>
                        <button v-if="user.level === 0" class="btn btn-success" @click="showNoticeForm = !showNoticeForm">
                            <i class="fas fa-plus me-1"></i>{{ showNoticeForm ? 'å–æ¶ˆæ–°å¢' : 'æ–°å¢å…¬å‘Š' }}
                        </button>
                    </div>
                    
                    <!-- æ–°å¢/ç¼–è¾‘å…¬å‘Šè¡¨å–® -->
                    <div v-if="showNoticeForm && user.level === 0" class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-bullhorn me-2"></i>{{ editingNoticeId ? 'ç¼–è¾‘å…¬å‘Š' : 'æ–°å¢å…¬å‘Š' }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <form @submit.prevent="submitNotice">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="mb-3">
                                            <label class="form-label">å…¬å‘Šæ ‡é¢˜ <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" v-model="noticeForm.title" 
                                                   placeholder="è¯·è¾“å…¥å…¬å‘Šæ ‡é¢˜" maxlength="100" required>
                                            <div class="form-text">æ ‡é¢˜é•¿åº¦ï¼š{{ (noticeForm.title || '').length }}/100</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">å…¬å‘Šåˆ†é¡</label>
                                            <select class="form-select" v-model="noticeForm.category">
                                                <option value="æœ€æ–°å…¬å‘Š">æœ€æ–°å…¬å‘Š</option>
                                                <option value="ç¶­ä¿®">ç¶­ä¿®</option>
                                                <option value="æ´»å‹•">æ´»å‹•</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">å…¬å‘Šå†…å®¹ <span class="text-danger">*</span></label>
                                    <textarea class="form-control" v-model="noticeForm.content" 
                                              placeholder="è¯·è¾“å…¥å…¬å‘Šå†…å®¹" rows="5" required></textarea>
                                    <div class="form-text">å†…å®¹é•¿åº¦ï¼š{{ (noticeForm.content || '').length }} å­—ç¬¦</div>
                                </div>
                                
                                <!-- é¢„è§ˆå€åŸŸ -->
                                <div class="mb-3">
                                    <label class="form-label">å…¬å‘Šé¢„è§ˆ</label>
                                    <div class="border rounded p-3 bg-light">
                                        <div class="d-flex align-items-center mb-2">
                                            <span class="badge me-2" 
                                                  :class="{
                                                      'bg-info': noticeForm.category === 'æœ€æ–°å…¬å‘Š',
                                                      'bg-warning': noticeForm.category === 'ç¶­ä¿®',
                                                      'bg-success': noticeForm.category === 'æ´»å‹•'
                                                  }">
                                                {{ noticeForm.category }}
                                            </span>
                                            <h6 class="mb-0">{{ noticeForm.title || 'å…¬å‘Šæ ‡é¢˜' }}</h6>
                                        </div>
                                        <p class="mb-0 text-muted">{{ noticeForm.content || 'å…¬å‘Šå†…å®¹' }}</p>
                                        <small class="text-muted">
                                            <i class="fas fa-clock me-1"></i>{{ getCurrentDateTime() }}
                                        </small>
                                    </div>
                                </div>
                                
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" @click="cancelNoticeEdit">å–æ¶ˆ</button>
                                    <button type="submit" class="btn btn-primary" :disabled="loading">
                                        <span v-if="loading" class="spinner-border spinner-border-sm me-1" role="status"></span>
                                        <i class="fas fa-save me-1" v-if="!loading"></i>
                                        {{ editingNoticeId ? 'æ›´æ–°å…¬å‘Š' : 'å‘å¸ƒå…¬å‘Š' }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- åˆ†é¡ç­›é€‰ -->
                    <div class="card mb-4">
                        <div class="card-header">
                            å…¬å‘Šåˆ†é¡
                        </div>
                        <div class="card-body">
                            <div class="btn-group" role="group">
                                <input type="radio" class="btn-check" name="noticeCategory" id="categoryAll" v-model="selectedNoticeCategory" value="all" @change="filterNoticesByCategory('all')">
                                <label class="btn btn-outline-primary" for="categoryAll">å…¨éƒ¨</label>
                                
                                <input type="radio" class="btn-check" name="noticeCategory" id="categoryNews" v-model="selectedNoticeCategory" value="æœ€æ–°å…¬å‘Š" @change="filterNoticesByCategory('æœ€æ–°å…¬å‘Š')">
                                <label class="btn btn-outline-info" for="categoryNews">æœ€æ–°å…¬å‘Š</label>
                                
                                <input type="radio" class="btn-check" name="noticeCategory" id="categoryMaintenance" v-model="selectedNoticeCategory" value="ç¶­ä¿®" @change="filterNoticesByCategory('ç¶­ä¿®')">
                                <label class="btn btn-outline-warning" for="categoryMaintenance">ç¶­ä¿®</label>
                                
                                <input type="radio" class="btn-check" name="noticeCategory" id="categoryActivity" v-model="selectedNoticeCategory" value="æ´»å‹•" @change="filterNoticesByCategory('æ´»å‹•')">
                                <label class="btn btn-outline-success" for="categoryActivity">æ´»å‹•</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å…¬å‘Šåˆ—è¡¨ -->
                    <div class="card">
                        <div class="card-body">
                            <div v-if="notices.length === 0" class="text-center py-5">
                                <i class="fas fa-info-circle fa-3x text-muted mb-3"></i>
                                <p class="text-muted">æš«ç„¡å…¬å‘Š</p>
                            </div>
                            
                            <div v-else>
                                <div v-for="notice in notices" :key="notice.id" class="notice-item mb-4 p-3 border rounded">
                                    <div class="row">
                                        <div class="col-md-8">
                                            <div class="d-flex align-items-center mb-2">
                                                <span class="badge me-2" 
                                                      :class="{
                                                          'bg-info': notice.category === 'æœ€æ–°å…¬å‘Š',
                                                          'bg-warning': notice.category === 'ç¶­ä¿®',
                                                          'bg-success': notice.category === 'æ´»å‹•'
                                                      }">
                                                    {{ notice.category }}
                                                </span>
                                                <h5 class="mb-0">{{ notice.title }}</h5>
                                            </div>
                                            <p class="text-muted mb-0">{{ notice.content }}</p>
                                        </div>
                                        <div class="col-md-4 text-end">
                                            <div class="mb-2">
                                                <small class="text-muted">
                                                    <i class="fas fa-clock me-1"></i>
                                                    {{ formatDate(notice.created_at) }}
                                                </small>
                                            </div>
                                            <div v-if="user.level === 0" class="btn-group">
                                                <button class="btn btn-sm btn-outline-primary" @click="startEditNotice(notice)">
                                                    <i class="fas fa-edit me-1"></i>ç¼–è¾‘
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" @click="deleteNotice(notice)">
                                                    <i class="fas fa-trash me-1"></i>åˆ é™¤
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å®¢æœåŠŸèƒ½ -->
                <div v-if="activeTab === 'customer-service' && user.level === 0">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>å®¢æœåŠŸèƒ½</h2>
                        <div class="btn-group">
                            <button class="btn btn-primary" @click="showCSOperationModalFunc">
                                <i class="fas fa-exchange-alt me-1"></i>æ–°å¢è½¬å¸³
                            </button>
                        </div>
                    </div>
                    
                    <!-- å®¢æœåŠŸèƒ½æ¨™ç±¤é¡µ -->
                    <ul class="nav nav-tabs mb-4" v-if="user.username === 'ti2025A' || user.username === 'ti2025D' || user.username === 'MA@x9Kp#2025$zL7' || user.username === 'MD@y7Rw#2025$qX4'">
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: customerServiceTab === 'transactions'}" 
                               href="#" @click="customerServiceTab = 'transactions'">
                                <i class="fas fa-exchange-alt me-1"></i>è½¬å¸³è®°å½•
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: customerServiceTab === 'win-loss-control'}" 
                               href="#" @click="customerServiceTab = 'win-loss-control'; loadWinLossControls()">
                                <i class="fas fa-dice me-1"></i>è¾“èµ¢æ§åˆ¶
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" :class="{active: customerServiceTab === 'marquee'}" 
                               href="#" @click="customerServiceTab = 'marquee'; loadMarqueeMessages()">
                                <i class="fas fa-bullhorn me-1"></i>è·‘é¦¬ç‡ˆè¨­å®š
                            </a>
                        </li>
                    </ul>
                    
                    <!-- è½¬å¸³è®°å½•æ¨™ç±¤é¡µ -->
                    <div v-if="!customerServiceTab || customerServiceTab === 'transactions'">
                        <!-- åŠŸèƒ½è¯´æ˜å¡ç‰‡ -->
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card bg-info text-white">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3">
                                                <i class="fas fa-user-shield fa-2x"></i>
                                            </div>
                                            <div>
                                                <h5 class="card-title mb-1">å®¢æœæƒé™</h5>
                                                <p class="card-text mb-0">å¯ä»¥è°ƒæ•´ä»»ä½•ä»£ç†æˆ–ä¼šå‘˜çš„ä½™é¢</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-warning text-white">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3">
                                                <i class="fas fa-history fa-2x"></i>
                                            </div>
                                            <div>
                                                <h5 class="card-title mb-1">å®Œæ•´è®°å½•</h5>
                                                <p class="card-text mb-0">æ‰€æœ‰æ“ä½œéƒ½ä¼šè®°å½•åœ¨ç³»ç»Ÿä¸­</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-success text-white">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3">
                                                <i class="fas fa-bullhorn fa-2x"></i>
                                            </div>
                                            <div>
                                                <h5 class="card-title mb-1">å…¬å‘Šç®¡ç†</h5>
                                                <p class="card-text mb-0">å¯ä»¥æ–°å¢å’Œç®¡ç†ç³»ç»Ÿå…¬å‘Š</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ“ä½œè®°å½• -->
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">å®¢æœæ“ä½œè®°å½•</h5>
                                <div class="d-flex gap-2">
                                    <!-- ç­›é€‰é€‰é¡¹ -->
                                    <select class="form-select form-select-sm" v-model="csTransactionFilters.userType" @change="loadCSTransactions(1)">
                                        <option value="all">å…¨éƒ¨ç”¨æˆ¶</option>
                                        <option value="agent">ä»£ç†</option>
                                        <option value="member">ä¼šå‘˜</option>
                                    </select>
                                    <select class="form-select form-select-sm" v-model="csTransactionFilters.transactionType" @change="loadCSTransactions(1)">
                                        <option value="all">å…¨éƒ¨æ“ä½œ</option>
                                        <option value="cs_deposit">å®¢æœå­˜æ¬¾</option>
                                        <option value="cs_withdraw">å®¢æœææ¬¾</option>
                                    </select>
                                    <button class="btn btn-sm btn-outline-primary" @click="loadCSTransactions(1)">
                                        <i class="fas fa-sync me-1"></i>åˆ·æ–°
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                        <tr>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç·¨å·</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶ç±»å‹</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œç±»å‹</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">è®ŠåŒ–é‡‘é¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå‰ä½™é¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œå¾Œä½™é¢</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">è¯´æ˜</th>
                                            <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œæ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody v-if="csTransactions.length > 0">
                                        <tr v-for="transaction in csTransactions" :key="transaction.id">
                                            <td>{{ transaction.id }}</td>
                                            <td>
                                                <span class="badge" :class="transaction.user_type === 'agent' ? 'bg-primary' : 'bg-info'">
                                                    {{ transaction.user_type === 'agent' ? 'ä»£ç†' : 'ä¼šå‘˜' }}
                                                </span>
                                            </td>
                                            <td>{{ transaction.username }}</td>
                                            <td>
                                                <span class="badge" :class="transaction.type === 'cs_deposit' ? 'bg-success' : 'bg-danger'">
                                                    {{ transaction.type === 'cs_deposit' ? 'å®¢æœå­˜æ¬¾' : 'å®¢æœææ¬¾' }}
                                                </span>
                                            </td>
                                            <td>
                                                <span :class="transaction.amount >= 0 ? 'text-success' : 'text-danger'">
                                                    {{ transaction.amount >= 0 ? '+' : '' }}{{ formatMoney(transaction.amount) }}
                                                </span>
                                            </td>
                                            <td>{{ formatMoney(transaction.before_balance) }}</td>
                                            <td>{{ formatMoney(transaction.after_balance) }}</td>
                                            <td>{{ transaction.description || '-' }}</td>
                                            <td>{{ formatDateTime(transaction.created_at) }}</td>
                                        </tr>
                                    </tbody>
                                    <tbody v-else>
                                        <tr>
                                            <td colspan="9" class="text-center text-muted py-4">
                                                <i class="fas fa-info-circle fa-2x mb-2"></i>
                                                <div>æš«ç„¡å®¢æœæ“ä½œè®°å½•</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- åˆ†é¡µ -->
                            <nav v-if="csTransactionsPagination.total > csTransactionsPagination.limit">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item" :class="{disabled: csTransactionsPagination.page <= 1}">
                                        <a class="page-link" href="#" @click.prevent="loadCSTransactionsPrevPage">ä¸Šä¸€é¡µ</a>
                                    </li>
                                    <li class="page-item active">
                                        <span class="page-link">{{ csTransactionsPagination.page }} / {{ Math.ceil(csTransactionsPagination.total / csTransactionsPagination.limit) }}</span>
                                    </li>
                                    <li class="page-item" :class="{disabled: csTransactionsPagination.page >= Math.ceil(csTransactionsPagination.total / csTransactionsPagination.limit)}">
                                        <a class="page-link" href="#" @click.prevent="loadCSTransactionsNextPage">ä¸‹ä¸€é¡µ</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    </div>
                    
                    <!-- è¾“èµ¢æ§åˆ¶æ¨™ç±¤é¡µ -->
                    <div v-if="customerServiceTab === 'win-loss-control' && (user.username === 'ti2025A' || user.username === 'ti2025D' || user.username === 'MA@x9Kp#2025$zL7' || user.username === 'MD@y7Rw#2025$qX4')">
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <h5><i class="fas fa-dice me-2"></i>è¾“èµ¢æ§åˆ¶ç³»ç»Ÿ</h5>
                                    <p class="mb-0">æ‚¨å¯ä»¥è®¾å®šéŠæˆ²çš„è¾“èµ¢æ§åˆ¶æ¨¡å¼ï¼Œç›®å‰æ”¯æ´å››ç¨®æ¨¡å¼ï¼š</p>
                        <ul class="mb-0 mt-2">
                            <li><strong>æ­£å¸¸æ©Ÿç‡ï¼š</strong>æŒ‰æ­£å¸¸æ©Ÿç‡å¼€å¥–ï¼Œç„¡ç‰¹æ®Šæ§åˆ¶</li>
                            <li><strong>ä»£ç†ç·šæ§åˆ¶ï¼š</strong>é’ˆå¯¹æŒ‡å®šä»£ç†ç·šè¿›è¡Œè¾“èµ¢æ§åˆ¶</li>
                            <li><strong>å–®ä¼šå‘˜æ§åˆ¶ï¼š</strong>é’ˆå¯¹æŒ‡å®šä¼šå‘˜è¿›è¡Œè¾“èµ¢æ§åˆ¶</li>
                            <li><strong>è‡ªå‹•åµæ¸¬æ§åˆ¶ï¼š</strong>ç³»ç»Ÿæ™ºèƒ½åµæ¸¬å…¨ä½“è¾“èµ¢æ¯”ä¾‹ï¼Œè®©å¹³å°å°èµ¢ï¼Œä¸‹çº¿å°è¾“</li>
                        </ul>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å½“å‰æ´»èºæ§åˆ¶çŠ¶æ€ -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="card" :class="activeWinLossControl.is_active ? 'border-success' : 'border-secondary'">
                                    <div class="card-header" :class="activeWinLossControl.is_active ? 'bg-success text-white' : 'bg-secondary text-white'">
                                        <h5 class="mb-0">
                                            <i class="fas fa-cog me-2"></i>å½“å‰æ§åˆ¶çŠ¶æ€
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <strong>æ§åˆ¶æ¨¡å¼ï¼š</strong>
                                            <span class="badge" :class="{
                                                'bg-primary': activeWinLossControl.control_mode === 'normal',
                                                'bg-warning': activeWinLossControl.control_mode === 'agent_line',
                                                'bg-info': activeWinLossControl.control_mode === 'single_member',
                                                'bg-secondary': activeWinLossControl.control_mode === 'auto_detect'
                                            }">
                                                {{ getControlModeText(activeWinLossControl.control_mode) }}
                                            </span>
                                        </div>
                                        <div class="mb-2" v-if="activeWinLossControl.target_display_name">
                                            <strong>æ§åˆ¶ç›®æ ‡ï¼š</strong>
                                            <span class="text-primary">{{ activeWinLossControl.target_display_name }}</span>
                                            <span class="badge ms-1" :class="activeWinLossControl.target_type === 'agent' ? 'bg-primary' : 'bg-info'">
                                                {{ activeWinLossControl.target_type === 'agent' ? 'ä»£ç†' : 'ä¼šå‘˜' }}
                                            </span>
                                        </div>
                                        <div class="mb-2" v-if="activeWinLossControl.control_percentage">
                                            <strong>æ§åˆ¶æ¯”ä¾‹ï¼š</strong>
                                            <span class="text-info">{{ activeWinLossControl.control_percentage }}%</span>
                                        </div>
                                        <div class="mb-2">
                                            <strong>æ§åˆ¶ç±»å‹ï¼š</strong>
                                            <span v-if="activeWinLossControl.win_control" class="badge bg-success me-1">èµ¢æ§åˆ¶</span>
                                            <span v-if="activeWinLossControl.loss_control" class="badge bg-danger me-1">è¾“æ§åˆ¶</span>
                                            <span v-if="!activeWinLossControl.win_control && !activeWinLossControl.loss_control" class="badge bg-secondary">ç„¡æ§åˆ¶</span>
                                        </div>
                                        <div class="mb-0">
                                            <strong>çŠ¶æ€ï¼š</strong>
                                            <span class="badge" :class="activeWinLossControl.is_active ? 'bg-success' : 'bg-secondary'">
                                                {{ activeWinLossControl.is_active ? 'å¯ç”¨ä¸­' : 'æœªå¯ç”¨' }}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card border-primary">
                                    <div class="card-header bg-primary text-white">
                                        <h5 class="mb-0">
                                            <i class="fas fa-plus-circle me-2"></i>æ–°å¢æ§åˆ¶è®¾å®š
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <form @submit.prevent="createWinLossControl">
                                            <div class="mb-3">
                                                <label class="form-label">æ§åˆ¶æ¨¡å¼</label>
                                                <select class="form-select" v-model="newWinLossControl.control_mode" required>
                                                    <option value="normal">æ­£å¸¸æ©Ÿç‡</option>
                                                    <option value="agent_line">ä»£ç†ç·šæ§åˆ¶</option>
                                                    <option value="single_member">å–®ä¼šå‘˜æ§åˆ¶</option>
                                                    <option value="auto_detect">è‡ªå‹•åµæ¸¬æ§åˆ¶</option>
                                                </select>
                                            </div>
                                            
                                            <div v-if="newWinLossControl.control_mode === 'agent_line' || newWinLossControl.control_mode === 'single_member'" class="mb-3">
                                                <label class="form-label">ç›®æ ‡ç±»å‹</label>
                                                <select class="form-select" v-model="newWinLossControl.target_type" required>
                                                    <option value="">è¯·é€‰æ‹©ç›®æ ‡ç±»å‹</option>
                                                    <option value="agent" v-if="newWinLossControl.control_mode === 'agent_line'">ä»£ç†</option>
                                                    <option value="member" v-if="newWinLossControl.control_mode === 'single_member'">ä¼šå‘˜</option>
                                                </select>
                                            </div>
                                            
                                            <div v-if="newWinLossControl.target_type" class="mb-3">
                                                <label class="form-label">ç›®æ ‡ç”¨æˆ¶å</label>
                                                <select class="form-select" v-model="newWinLossControl.target_username" required>
                                                    <option value="">è¯·é€‰æ‹©{{ newWinLossControl.target_type === 'agent' ? 'ä»£ç†' : 'ä¼šå‘˜' }}</option>
                                                    <template v-if="newWinLossControl.target_type === 'agent'">
                                                        <option v-for="agent in availableAgents" :key="agent.id" :value="agent.username">
                                                            {{ agent.username }} ({{ agent.level_name }})
                                                        </option>
                                                    </template>
                                                    <template v-if="newWinLossControl.target_type === 'member'">
                                                        <option v-for="member in availableMembers" :key="member.id" :value="member.username">
                                                            {{ member.username }} ({{ member.agent_level_name }} - {{ member.agent_username }})
                                                        </option>
                                                    </template>
                                                </select>
                                            </div>
                                            
                                            <!-- æ§åˆ¶æ¯”ä¾‹è®¾å®š - è‡ªå‹•åµæ¸¬æ¨¡å¼ä¸éœ€è¦ -->
                                            <div v-if="newWinLossControl.control_mode !== 'normal' && newWinLossControl.control_mode !== 'auto_detect'" class="mb-3">
                                                <label class="form-label">æ§åˆ¶æ¯”ä¾‹ (%)</label>
                                                <input type="number" class="form-control" v-model="newWinLossControl.control_percentage" 
                                                       min="0" max="100" step="0.01" placeholder="50.00" required>
                                            </div>
                                            
                                            <!-- è‡ªå‹•åµæ¸¬æ¨¡å¼è¯´æ˜ -->
                                            <div v-if="newWinLossControl.control_mode === 'auto_detect'" class="mb-3">
                                                <div class="alert alert-info">
                                                    <h6 class="alert-heading"><i class="fas fa-robot me-2"></i>è‡ªå‹•åµæ¸¬æ§åˆ¶</h6>
                                                    <p class="mb-2">ç³»ç»Ÿå°‡è‡ªå‹•åµæ¸¬å…¨ä½“ä¸‹çº¿ä¸å¹³å°çš„è¾“èµ¢æ¯”ä¾‹ï¼Œæ™ºèƒ½è°ƒæ•´å¼€å¥–ç»“æœã€‚</p>
                                                    <p class="mb-2"><strong>ç›®æ ‡ï¼š</strong>è®©å¹³å°å°èµ¢ï¼Œå…¨ä½“ä¸‹çº¿å°è¾“</p>
                                                    <p class="mb-0"><small class="text-muted">æ­¤æ¨¡å¼ç„¡éœ€è®¾å®šæ§åˆ¶æ¯”ä¾‹æˆ–æ§åˆ¶ç±»å‹ï¼Œç³»ç»Ÿä¼šè‡ªå‹•ä¼˜åŒ–ã€‚</small></p>
                                                </div>
                                            </div>
                                            
                                            <!-- æ§åˆ¶ç±»å‹è®¾å®š - è‡ªå‹•åµæ¸¬æ¨¡å¼ä¸éœ€è¦ -->
                                            <div v-if="newWinLossControl.control_mode !== 'normal' && newWinLossControl.control_mode !== 'auto_detect'" class="mb-3">
                                                <label class="form-label">æ§åˆ¶ç±»å‹</label>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" v-model="newWinLossControl.win_control" id="winControl">
                                                    <label class="form-check-label" for="winControl">
                                                        èµ¢æ§åˆ¶ï¼ˆè®©ç›®æ ‡æ›´å®¹æ˜“èµ¢ï¼‰
                                                    </label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" v-model="newWinLossControl.loss_control" id="lossControl">
                                                    <label class="form-check-label" for="lossControl">
                                                        è¾“æ§åˆ¶ï¼ˆè®©ç›®æ ‡æ›´å®¹æ˜“è¾“ï¼‰
                                                    </label>
                                                </div>
                                            </div>
                                            
                                            <!-- å¼€å§‹æœŸæ•¸è®¾å®š - æ‰€æœ‰éæ­£å¸¸æ¨¡å¼éƒ½éœ€è¦ -->
                                            <div v-if="newWinLossControl.control_mode !== 'normal'" class="mb-3">
                                                <label class="form-label">å¼€å§‹æœŸæ•¸</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                                                    <input type="number" class="form-control" v-model="newWinLossControl.start_period" 
                                                           :min="currentPeriodInfo.next_period" placeholder="è®¾å®šå¾ç¬¬å¹¾æœŸå¼€å§‹æ§åˆ¶" required>
                                                </div>
                                                <small class="form-text text-muted">
                                                    å½“å‰æœŸæ•¸ï¼š{{ currentPeriodInfo.current_period }} | å»ºè®®ä¸‹ä¸€æœŸï¼š{{ currentPeriodInfo.next_period }}
                                                    <span v-if="newWinLossControl.control_mode === 'auto_detect'">
                                                        <br><i class="fas fa-info-circle me-1"></i>è‡ªå‹•åµæ¸¬å°‡å¾æ­¤æœŸæ•¸å¼€å§‹åˆ†æå’Œè°ƒæ•´
                                                    </span>
                                                </small>
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary w-100" :disabled="loading">
                                                <span v-if="loading" class="spinner-border spinner-border-sm me-1"></span>
                                                <i v-else class="fas fa-save me-1"></i>
                                                {{ loading ? 'è®¾å®šä¸­...' : 'åˆ›å»ºæ§åˆ¶è®¾å®š' }}
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ§åˆ¶è®¾å®šåˆ—è¡¨ -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-list me-2"></i>è¾“èµ¢æ§åˆ¶è®°å½•
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                            <tr>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ID</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ§åˆ¶æ¨¡å¼</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç›®æ ‡ç±»å‹</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç›®æ ‡ç”¨æˆ¶</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ§åˆ¶æ¯”ä¾‹</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ§åˆ¶ç±»å‹</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">çŠ¶æ€</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œè€…</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">åˆ›å»ºæ—¶é—´</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œ</th>
                                            </tr>
                                        </thead>
                                        <tbody v-if="winLossControls.length > 0">
                                            <tr v-for="control in winLossControls" :key="control.id">
                                                <td>{{ control.id }}</td>
                                                <td>
                                                    <span class="badge" :class="{
                                                        'bg-primary': control.control_mode === 'normal',
                                                        'bg-warning': control.control_mode === 'agent_line',
                                                        'bg-info': control.control_mode === 'single_member',
                                                        'bg-secondary': control.control_mode === 'auto_detect'
                                                    }">
                                                        {{ getControlModeText(control.control_mode) }}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span v-if="control.target_type" class="badge" :class="control.target_type === 'agent' ? 'bg-primary' : 'bg-info'">
                                                        {{ control.target_type === 'agent' ? 'ä»£ç†' : 'ä¼šå‘˜' }}
                                                    </span>
                                                    <span v-else>-</span>
                                                </td>
                                                <td>{{ control.target_display_name || '-' }}</td>
                                                <td>
                                                    <span v-if="control.control_mode === 'auto_detect'" class="badge bg-secondary">è‡ªå‹•</span>
                                                    <span v-else>{{ control.control_percentage ? control.control_percentage + '%' : '-' }}</span>
                                                </td>
                                                <td>
                                                    <span v-if="control.control_mode === 'auto_detect'" class="badge bg-info">æ™ºèƒ½è°ƒæ•´</span>
                                                    <template v-else>
                                                        <span v-if="control.win_control" class="badge bg-success me-1">èµ¢</span>
                                                        <span v-if="control.loss_control" class="badge bg-danger me-1">è¾“</span>
                                                        <span v-if="!control.win_control && !control.loss_control">-</span>
                                                    </template>
                                                </td>
                                                <td>
                                                    <span class="badge" :class="control.is_active ? 'bg-success' : 'bg-secondary'">
                                                        {{ control.is_active ? 'å¯ç”¨' : 'åœç”¨' }}
                                                    </span>
                                                </td>
                                                <td>{{ control.operator_username }}</td>
                                                <td>{{ formatDateTime(control.created_at) }}</td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button v-if="!control.is_active" class="btn btn-outline-success btn-sm" 
                                                                @click="activateWinLossControl(control.id)" title="å¯ç”¨">
                                                            <i class="fas fa-play"></i>
                                                        </button>
                                                        <button v-if="control.is_active" class="btn btn-outline-warning btn-sm" 
                                                                @click="deactivateWinLossControl(control.id)" title="åœç”¨">
                                                            <i class="fas fa-pause"></i>
                                                        </button>
                                                        <button class="btn btn-outline-danger btn-sm" 
                                                                @click="deleteWinLossControl(control.id)" title="åˆ é™¤">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <tbody v-else>
                                            <tr>
                                                <td colspan="10" class="text-center text-muted py-4">
                                                    <i class="fas fa-info-circle fa-2x mb-2"></i>
                                                    <div>æš«ç„¡è¾“èµ¢æ§åˆ¶è®°å½•</div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è·‘é¦¬ç‡ˆè¨­å®šæ¨™ç±¤é  -->
                    <div v-if="customerServiceTab === 'marquee' && (user.username === 'ti2025A' || user.username === 'ti2025D' || user.username === 'MA@x9Kp#2025$zL7' || user.username === 'MD@y7Rw#2025$qX4')">
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <h5><i class="fas fa-bullhorn me-2"></i>è·‘é¦¬ç‡ˆè¨­å®š</h5>
                                    <p class="mb-0">æ‚¨å¯ä»¥è¨­å®šåœ¨éŠæˆ²ç«¯é¡¯ç¤ºçš„è·‘é¦¬ç‡ˆè¨Šæ¯ï¼Œè¨Šæ¯æœƒåœ¨éŠæˆ²ä¸»ç•«é¢ä¸Šæ–¹æ»¾å‹•é¡¯ç¤ºã€‚</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ–°å¢è·‘é¦¬ç‡ˆè¨Šæ¯ -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header bg-primary text-white">
                                        <h5 class="mb-0"><i class="fas fa-plus-circle me-2"></i>æ–°å¢è·‘é¦¬ç‡ˆè¨Šæ¯</h5>
                                    </div>
                                    <div class="card-body">
                                        <form @submit.prevent="addMarqueeMessage">
                                            <div class="row">
                                                <div class="col-md-8">
                                                    <div class="mb-3">
                                                        <label class="form-label">è¨Šæ¯å…§å®¹</label>
                                                        <input type="text" class="form-control" v-model="newMarqueeMessage" 
                                                               placeholder="è«‹è¼¸å…¥è·‘é¦¬ç‡ˆè¨Šæ¯å…§å®¹" required>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="mb-3">
                                                        <label class="form-label">å„ªå…ˆç´š</label>
                                                        <input type="number" class="form-control" v-model.number="newMarqueePriority" 
                                                               placeholder="0" min="0" max="999">
                                                        <small class="text-muted">æ•¸å­—è¶Šå¤§è¶Šå„ªå…ˆ</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="mb-3">
                                                        <label class="form-label">&nbsp;</label>
                                                        <button type="submit" class="btn btn-primary w-100">
                                                            <i class="fas fa-plus me-1"></i>æ–°å¢
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ç¾æœ‰è·‘é¦¬ç‡ˆè¨Šæ¯åˆ—è¡¨ -->
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>ç¾æœ‰è·‘é¦¬ç‡ˆè¨Šæ¯</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>è¨Šæ¯å…§å®¹</th>
                                                        <th style="width: 100px;">å„ªå…ˆç´š</th>
                                                        <th style="width: 100px;">ç‹€æ…‹</th>
                                                        <th style="width: 150px;">å»ºç«‹æ™‚é–“</th>
                                                        <th style="width: 120px;">æ“ä½œ</th>
                                                    </tr>
                                                </thead>
                                                <tbody v-if="marqueeMessages.length > 0">
                                                    <tr v-for="message in marqueeMessages" :key="message.id">
                                                        <td>{{ message.message }}</td>
                                                        <td>{{ message.priority || 0 }}</td>
                                                        <td>
                                                            <span class="badge" :class="message.is_active ? 'bg-success' : 'bg-secondary'">
                                                                {{ message.is_active ? 'å•Ÿç”¨' : 'åœç”¨' }}
                                                            </span>
                                                        </td>
                                                        <td>{{ formatDateTime(message.created_at) }}</td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button v-if="!message.is_active" 
                                                                        class="btn btn-outline-success btn-sm" 
                                                                        @click="toggleMarqueeMessage(message.id, true)" 
                                                                        title="å•Ÿç”¨">
                                                                    <i class="fas fa-check"></i>
                                                                </button>
                                                                <button v-if="message.is_active" 
                                                                        class="btn btn-outline-warning btn-sm" 
                                                                        @click="toggleMarqueeMessage(message.id, false)" 
                                                                        title="åœç”¨">
                                                                    <i class="fas fa-pause"></i>
                                                                </button>
                                                                <button class="btn btn-outline-danger btn-sm" 
                                                                        @click="deleteMarqueeMessage(message.id)" 
                                                                        title="åˆªé™¤">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <tbody v-else>
                                                    <tr>
                                                        <td colspan="5" class="text-center text-muted py-4">
                                                            <i class="fas fa-info-circle fa-2x mb-2"></i>
                                                            <div>æš«ç„¡è·‘é¦¬ç‡ˆè¨Šæ¯</div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä»£ç†é¢åº¦ä¿®æ”¹æ¨¡æ…‹æ¡† -->
        <div class="modal fade" id="adjustAgentBalanceModal" tabindex="-1" aria-labelledby="adjustAgentBalanceModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="adjustAgentBalanceModalLabel">ç‚¹æ•°è½¬ç§»</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form @submit.prevent="submitAgentBalanceAdjustment">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">æ‚¨çš„ä½™é¢</label>
                                <input type="text" class="form-control" :value="formatMoney(user.balance)" disabled>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">ä¸‹ç´šä»£ç†ä½™é¢</label>
                                <input type="text" class="form-control" :value="formatMoney(agentBalanceData.currentBalance)" disabled>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»ç±»å‹</label>
                            <div class="btn-group w-100">
                                <input type="radio" class="btn-check" name="agentTransferType" id="agentDeposit" v-model="agentTransferType" value="deposit">
                                <label class="btn btn-outline-success" for="agentDeposit">å­˜å…¥ (æ‚¨â†’ä¸‹ç´šä»£ç†)</label>
                                
                                <input type="radio" class="btn-check" name="agentTransferType" id="agentWithdraw" v-model="agentTransferType" value="withdraw">
                                <label class="btn btn-outline-danger" for="agentWithdraw">æé¢† (ä¸‹ç´šä»£ç†â†’æ‚¨)</label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">ç‚¹æ•°è½¬ç§»é‡‘é¢</label>
                            <div class="input-group">
                                <input type="number" step="0.01" class="form-control" v-model="agentTransferAmount" 
                                       placeholder="è¯·è¾“å…¥è¦è½¬ç§»çš„ç‚¹æ•°é‡‘é¢" min="0" required>
                                <button type="button" class="btn btn-outline-primary" @click="setMaxAgentAmount()">
                                    <i class="fas fa-coins me-1"></i>å…¨éƒ¨ä½™é¢
                                </button>
                                <span class="input-group-text">å…ƒ</span>
                            </div>
                            <small class="form-text text-muted">
                                {{ agentTransferType === 'deposit' ? 'ç‚¹å‡»ã€Œå…¨éƒ¨ä½™é¢ã€å°‡å¡«å…¥æ‚¨çš„å…¨éƒ¨ä½™é¢' : 'ç‚¹å‡»ã€Œå…¨éƒ¨ä½™é¢ã€å°‡å¡«å…¥ä¸‹ç´šä»£ç†çš„å…¨éƒ¨ä½™é¢' }}
                            </small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»å¾Œä¸‹ç´šä»£ç†ç‚¹æ•°</label>
                            <input type="text" class="form-control" 
                                   :value="formatMoney(calculateFinalSubAgentBalance())" 
                                   disabled>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»å¾Œæ‚¨çš„ç‚¹æ•°</label>
                            <input type="text" class="form-control" 
                                   :value="formatMoney(calculateFinalParentAgentBalance())" 
                                   disabled>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                            <textarea class="form-control" v-model="agentBalanceData.description" 
                                      placeholder="è¯·è¾“å…¥ç‚¹æ•°è½¬ç§»åŸå› "></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" @click="submitAgentBalanceAdjustment" :disabled="!isValidAgentTransfer">
                        <i class="fas fa-check me-1"></i>ç¡®è®¤è½¬ç§»
                    </button>
                </div>
            </div>
        </div>
        </div>

        <!-- é‡è®¾å¯†ç  Modal -->
        <div class="modal fade" id="resetPasswordModal" tabindex="-1" aria-labelledby="resetPasswordModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="resetPasswordModalLabel">é‡è®¾å¯†ç </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="submitPasswordReset">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                ä¸ºäº†å®‰å…¨èµ·è§ï¼ŒèˆŠå¯†ç ä¸ä¼šæ˜¾ç¤ºã€‚è¯·ç›´æ¥è¾“å…¥æ–°å¯†ç ã€‚
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ç”¨æˆ¶ç±»å‹</label>
                                <input type="text" class="form-control" :value="resetPasswordData.userType === 'agent' ? 'ä»£ç†' : 'ä¼šå‘˜'" readonly>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ç”¨æˆ¶å</label>
                                <input type="text" class="form-control" :value="resetPasswordData.username" readonly>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">æ–°å¯†ç  <span class="text-danger">*</span></label>
                                <input type="password" class="form-control" v-model="resetPasswordData.newPassword" required 
                                       placeholder="è¯·è¾“å…¥æ–°å¯†ç " minlength="6">
                                <small class="form-text text-muted">å¯†ç é•¿åº¦è‡³å°‘6ä¸ªå­—ç¬¦</small>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ç¡®è®¤æ–°å¯†ç  <span class="text-danger">*</span></label>
                                <input type="password" class="form-control" v-model="resetPasswordData.confirmPassword" required 
                                       placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ">
                            </div>
                            
                            <div class="mb-3" v-if="resetPasswordData.newPassword && resetPasswordData.confirmPassword">
                                <div v-if="resetPasswordData.newPassword === resetPasswordData.confirmPassword" class="text-success">
                                    <i class="fas fa-check me-1"></i>å¯†ç åŒ¹é…
                                </div>
                                <div v-else class="text-danger">
                                    <i class="fas fa-times me-1"></i>ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´
                                </div>
                            </div>
                            
                            <div class="text-end">
                                <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="submit" class="btn btn-warning" :disabled="!isPasswordResetValid || loading">
                                    <span v-if="loading" class="spinner-border spinner-border-sm me-1" role="status"></span>
                                    <i class="fas fa-key me-1" v-if="!loading"></i>
                                    é‡è®¾å¯†ç 
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸ªäººèµ„æ–™ Modal -->
                    <div v-if="isProfileModalVisible && isLoggedIn && user && user.id && modalSystemReady" class="modal d-block" id="profileModal" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-user me-2"></i>ä¸ªäººèµ„æ–™
                        </h5>
                        <button type="button" class="btn-close" @click="hideProfileModal"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="updateProfile">
                            <div class="row">
                                <!-- åŸºæœ¬ä¿¡æ¯ -->
                                <div class="col-md-6">
                                    <h6 class="text-primary mb-3">
                                        <i class="fas fa-id-card me-1"></i>åŸºæœ¬ä¿¡æ¯
                                    </h6>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">ç”¨æˆ¶å</label>
                                        <input type="text" class="form-control" :value="user.username" readonly>
                                        <small class="form-text text-muted">ç”¨æˆ¶åç„¡æ³•ä¿®æ”¹</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">ä»£ç†çº§åˆ«</label>
                                        <input type="text" class="form-control" :value="getLevelName(user.level)" readonly>
                                        <small class="form-text text-muted">ä»£ç†çº§åˆ«ç„¡æ³•ä¿®æ”¹</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">çœŸå¯¦å§“å</label>
                                        <input type="text" class="form-control" v-model="profileData.realName" 
                                               placeholder="è¯·è¾“å…¥çœŸå¯¦å§“å">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">è”ç»œç”µè¯</label>
                                        <input type="tel" class="form-control" v-model="profileData.phone" 
                                               placeholder="è¯·è¾“å…¥è”ç»œç”µè¯">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">ç”µå­é‚®ä»¶</label>
                                        <input type="email" class="form-control" v-model="profileData.email" 
                                               placeholder="è¯·è¾“å…¥ç”µå­é‚®ä»¶">
                                    </div>
                                </div>
                                
                                <!-- è¯¦ç»†ä¿¡æ¯ -->
                                <div class="col-md-6">
                                    <h6 class="text-primary mb-3">
                                        <i class="fas fa-info-circle me-1"></i>è¯¦ç»†ä¿¡æ¯
                                    </h6>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Line ID</label>
                                        <input type="text" class="form-control" v-model="profileData.lineId" 
                                               placeholder="è¯·è¾“å…¥Line ID">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Telegram</label>
                                        <input type="text" class="form-control" v-model="profileData.telegram" 
                                               placeholder="è¯·è¾“å…¥Telegram">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">åœ°å€</label>
                                        <textarea class="form-control" rows="3" v-model="profileData.address" 
                                                  placeholder="è¯·è¾“å…¥åœ°å€"></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">å¤‡æ³¨</label>
                                        <textarea class="form-control" rows="3" v-model="profileData.remark" 
                                                  placeholder="å…¶ä»–å¤‡æ³¨ä¿¡æ¯"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-secondary me-2" @click="hideProfileModal">å–æ¶ˆ</button>
                                <button type="submit" class="btn btn-primary" :disabled="profileLoading">
                                    <span v-if="profileLoading" class="spinner-border spinner-border-sm me-1" role="status"></span>
                                    <i class="fas fa-save me-1" v-if="!profileLoading"></i>
                                    å‚¨å­˜èµ„æ–™
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç¼–è¾‘ä¼šå‘˜å¤‡æ³¨ Modal -->
        <div class="modal fade" id="editMemberNotesModal" tabindex="-1" :class="{show: showEditMemberNotesModal}" :style="{display: showEditMemberNotesModal ? 'block' : 'none'}">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-sticky-note me-2 text-success"></i>
                            ç¼–è¾‘ä¼šå‘˜å¤‡æ³¨ - {{ editNotesData.username }}
                        </h5>
                        <button type="button" class="btn-close" @click="hideEditMemberNotesModal"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="updateMemberNotes">
                            <div class="mb-3">
                                <label class="form-label">ä¼šå‘˜èµ„è®¯</label>
                                <div class="p-3 bg-light rounded">
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>ä¼šå‘˜ID:</strong> {{ editNotesData.id }}
                                        </div>
                                        <div class="col-6">
                                            <strong>ç”¨æˆ¶å:</strong> {{ editNotesData.username }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                                <textarea class="form-control" v-model="editNotesData.notes" 
                                          placeholder="è¯·è¾“å…¥ä¼šå‘˜å¤‡æ³¨è¯´æ˜" rows="5" 
                                          style="resize: vertical;"></textarea>
                                <small class="form-text text-muted">
                                    å¯ç”¨æ–¼è®°å½•ä¼šå‘˜çš„ç‰¹æ®Šæƒ…å†µã€è”ç³»æ–¹å¼ã€æŠ•æ³¨ç¿’æ…£ã€é‡è¦æé†’ç­‰
                                </small>
                            </div>
                            <div class="text-end">
                                <button type="button" class="btn btn-secondary me-2" @click="hideEditMemberNotesModal">å–æ¶ˆ</button>
                                <button type="submit" class="btn btn-success" :disabled="loading">
                                    <span v-if="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                                    <i v-else class="fas fa-save me-1"></i>
                                    {{ loading ? 'å„²å­˜ä¸­...' : 'å„²å­˜å¤‡æ³¨' }}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ä¼šå‘˜ç‚¹æ•¸è½¬ç§» Modal -->
        <div class="modal fade" id="adjustMemberBalanceModal" tabindex="-1" aria-labelledby="adjustMemberBalanceModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="adjustMemberBalanceModalLabel">ä¼šå‘˜ç‚¹æ•¸è½¬ç§»</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form @submit.prevent="submitMemberBalanceTransfer">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">æ‚¨çš„ä½™é¢</label>
                                <input type="text" class="form-control" :value="formatMoney(user.balance)" disabled>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">ä¼šå‘˜ä½™é¢</label>
                                <input type="text" class="form-control" :value="formatMoney(memberBalanceData.currentBalance)" disabled>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»ç±»å‹</label>
                            <div class="btn-group w-100">
                                <input type="radio" class="btn-check" name="memberTransferType" id="memberDeposit" v-model="memberTransferType" value="deposit">
                                <label class="btn btn-outline-success" for="memberDeposit">å­˜å…¥ (æ‚¨â†’ä¼šå‘˜)</label>
                                
                                <input type="radio" class="btn-check" name="memberTransferType" id="memberWithdraw" v-model="memberTransferType" value="withdraw">
                                <label class="btn btn-outline-danger" for="memberWithdraw">æé¢† (ä¼šå‘˜â†’æ‚¨)</label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">ç‚¹æ•¸è½¬ç§»é‡‘é¢</label>
                            <div class="input-group">
                                <input type="number" step="0.01" class="form-control" v-model="memberTransferAmount" 
                                       placeholder="è¯·è¾“å…¥è¦è½¬ç§»çš„ç‚¹æ•¸é‡‘é¢" min="0" required>
                                <button type="button" class="btn btn-outline-primary" @click="setMaxMemberAmount()">
                                    <i class="fas fa-coins me-1"></i>å…¨éƒ¨ä½™é¢
                                </button>
                                <span class="input-group-text">å…ƒ</span>
                            </div>
                            <small class="form-text text-muted">
                                {{ memberTransferType === 'deposit' ? 'ç‚¹æ“Šã€Œå…¨éƒ¨ä½™é¢ã€å°‡å¡«å…¥æ‚¨çš„å…¨éƒ¨ä½™é¢' : 'ç‚¹æ“Šã€Œå…¨éƒ¨ä½™é¢ã€å°‡å¡«å…¥ä¼šå‘˜çš„å…¨éƒ¨ä½™é¢' }}
                            </small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»å¾Œä¼šå‘˜ç‚¹æ•¸</label>
                            <input type="text" class="form-control" 
                                   :value="formatMoney(calculateFinalMemberBalanceTransfer())" 
                                   disabled>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">è½¬ç§»å¾Œæ‚¨çš„ç‚¹æ•¸</label>
                            <input type="text" class="form-control" 
                                   :value="formatMoney(calculateFinalAgentBalanceFromMember())" 
                                   disabled>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                            <textarea class="form-control" v-model="memberBalanceData.description" 
                                      placeholder="è¯·è¾“å…¥ç‚¹æ•¸è½¬ç§»åŸå› "></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" @click="submitMemberBalanceTransfer" :disabled="!isValidMemberTransfer">
                        <i class="fas fa-check me-1"></i>ç¡®è®¤è½¬ç§»
                    </button>
                </div>
            </div>
        </div>
        </div>

        <!-- ä¿®æ”¹ä¼šå‘˜ä½™é¢ Modal -->
        <div class="modal fade" id="modifyMemberBalanceModal" tabindex="-1" aria-labelledby="modifyMemberBalanceModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modifyMemberBalanceModalLabel">
                            <i class="fas fa-exchange-alt me-2 text-primary"></i>
                            ä¿®æ”¹ä¼šå‘˜ä½™é¢ - {{ modifyBalanceData.memberUsername }}
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="submitModifyMemberBalance">
                            <div class="mb-3">
                                <label class="form-label">ä¼šå‘˜èµ„è®¯</label>
                                <div class="p-3 bg-light rounded">
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>ä¼šå‘˜ID:</strong> {{ modifyBalanceData.memberId }}
                                        </div>
                                        <div class="col-6">
                                            <strong>ç”¨æˆ¶å:</strong> {{ modifyBalanceData.memberUsername }}
                                        </div>
                                        <div class="col-12 mt-2">
                                            <strong>å½“å‰ä½™é¢:</strong> {{ formatMoney(modifyBalanceData.currentBalance) }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ä¿®æ”¹æ–¹å¼</label>
                                <div class="btn-group w-100">
                                    <input type="radio" class="btn-check" name="modifyBalanceType" id="absolute" v-model="modifyBalanceType" value="absolute">
                                    <label class="btn btn-outline-primary" for="absolute">çµ•å¯¹å€¼</label>
                                    
                                    <input type="radio" class="btn-check" name="modifyBalanceType" id="relative" v-model="modifyBalanceType" value="relative">
                                    <label class="btn btn-outline-secondary" for="relative">ç›¸å¯¹å€¼</label>
                                </div>
                                <small class="form-text text-muted">
                                    çµ•å¯¹å€¼ï¼šç›´æ¥è®¾å®šä¸ºæŒ‡å®šé‡‘é¢ï¼›ç›¸å¯¹å€¼ï¼šåœ¨å½“å‰ä½™é¢åŸºç¤ä¸Šå¢æ¸›
                                </small>
                            </div>
                            
                            <div class="mb-3" v-if="modifyBalanceType === 'relative'">
                                <label class="form-label">è®Šå‹•æ–¹å‘</label>
                                <div class="btn-group w-100">
                                    <input type="radio" class="btn-check" name="balanceChangeDirection" id="increase" v-model="balanceChangeDirection" value="increase">
                                    <label class="btn btn-outline-success" for="increase">å¢åŠ </label>
                                    
                                    <input type="radio" class="btn-check" name="balanceChangeDirection" id="decrease" v-model="balanceChangeDirection" value="decrease">
                                    <label class="btn btn-outline-danger" for="decrease">å‡å°‘</label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">
                                    {{ modifyBalanceType === 'absolute' ? 'è®¾å®šé‡‘é¢' : 'è®Šå‹•é‡‘é¢' }}
                                </label>
                                <div class="input-group">
                                    <input type="number" step="0.01" class="form-control" v-model="modifyBalanceAmount" 
                                           :placeholder="modifyBalanceType === 'absolute' ? 'è¯·è¾“å…¥è¦è®¾å®šçš„é‡‘é¢' : 'è¯·è¾“å…¥è®Šå‹•é‡‘é¢'" 
                                           min="0" required>
                                    <span class="input-group-text">å…ƒ</span>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ä¿®æ”¹å¾Œä½™é¢</label>
                                <input type="text" class="form-control" 
                                       :value="formatMoney(calculateFinalModifiedBalance())" 
                                       disabled>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">ä¿®æ”¹åŸå›  <span class="text-danger">*</span></label>
                                <textarea class="form-control" v-model="modifyBalanceData.reason" 
                                          placeholder="è¯·è¾“å…¥ä¿®æ”¹ä½™é¢çš„åŸå› " rows="3" required></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-primary" @click="submitModifyMemberBalance" 
                                :disabled="!modifyBalanceAmount || !modifyBalanceData.reason || loading">
                            <span v-if="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                            <i class="fas fa-check me-1" v-if="!loading"></i>
                            ç¡®è®¤ä¿®æ”¹
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è°ƒæ•´ä¼šå‘˜é™çº¢ Modal - ä½¿ç”¨v-ifæ§åˆ¶æ˜¾ç¤º -->
        <div v-if="showBettingLimitModal && isLoggedIn && user && user.id && modalSystemReady" 
             class="modal d-block" id="adjustBettingLimitModal" tabindex="-1" 
             style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-sliders-h me-2"></i>è°ƒæ•´ä¼šå‘˜é™çº¢
                        </h5>
                        <button type="button" class="btn-close" @click="hideBettingLimitModal"></button>
                    </div>
                    <div class="modal-body">
                        <!-- è½½å…¥çŠ¶æ€ -->
                        <div v-if="bettingLimitData.loading" class="text-center p-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">è½½å…¥ä¸­...</span>
                            </div>
                            <p class="mt-2">è½½å…¥é™çº¢é…ç½®ä¸­...</p>
                        </div>
                        
                        <!-- ä¸»è¦å†…å®¹ -->
                        <div v-else>
                            <!-- ä¼šå‘˜ä¿¡æ¯ -->
                            <div class="alert alert-info">
                                <h6><i class="fas fa-user me-2"></i>ä¼šå‘˜ä¿¡æ¯</h6>
                                <p class="mb-1"><strong>ç”¨æˆ¶å:</strong> {{ bettingLimitData.member.username }}</p>
                                <p class="mb-1"><strong>å½“å‰é™çº¢ç­‰çº§:</strong> 
                                    <span class="badge bg-secondary">{{ bettingLimitData.member.levelDisplayName }}</span>
                                </p>
                                <p class="mb-0"><strong>è¯´æ˜:</strong> {{ bettingLimitData.member.description }}</p>
                            </div>

                            <!-- é™çº¢ç­‰çº§é€‰æ‹© -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">é€‰æ‹©æ–°çš„é™çº¢ç­‰çº§</label>
                                <select class="form-select" v-model="bettingLimitData.newLimitLevel">
                                    <option value="">è¯·é€‰æ‹©é™çº¢ç­‰çº§</option>
                                    <option v-for="config in bettingLimitData.configs" 
                                            :key="config.level_name" 
                                            :value="config.level_name">
                                        {{ config.level_display_name }} - {{ config.description }}
                                    </option>
                                </select>
                            </div>

                            <!-- é™çº¢é…ç½®é¢„è§ˆ -->
                            <div v-if="bettingLimitData.newLimitLevel" class="mb-3">
                                <h6><i class="fas fa-eye me-2"></i>é™çº¢é…ç½®é¢„è§ˆ</h6>
                                <div class="table-responsive">
                                    <table class="table table-sm table-bordered">
                                        <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                            <tr>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç©æ³•</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å–®æ³¨æœ€é«˜</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å–®æœŸé™é¢</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="(config, key) in selectedLimitConfig" :key="key">
                                                <td>{{ formatBetTypeName(key) }}</td>
                                                <td class="text-success fw-bold">{{ formatMoney(config.maxBet) }}</td>
                                                <td class="text-primary fw-bold">{{ formatMoney(config.periodLimit) }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="alert alert-warning">
                                    <small>
                                        <i class="fas fa-info-circle me-1"></i>
                                        <strong>æ³¨æ„äº‹é¡¹ï¼š</strong><br>
                                        â€¢ å–®æ³¨æœ€é«˜ï¼šæ¯ç­†æŠ•æ³¨çš„æœ€é«˜é‡‘é¢é™åˆ¶<br>
                                        â€¢ å–®æœŸé™é¢ï¼šæ¯ä¸ªå¼€å¥–æœŸåŒç±»å‹æŠ•æ³¨çš„ç´¯è¨ˆé™é¢<br>
                                        â€¢ æœ€ä½æŠ•æ³¨é‡‘é¢çµ±ä¸€ä¸º1å…ƒ<br>
                                        â€¢ è¶…è¿‡é™é¢çš„æŠ•æ³¨å°‡è¢«ç³»ç»Ÿæ‹’ç»
                                    </small>
                                </div>
                            </div>

                            <!-- è°ƒæ•´åŸå›  -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">è°ƒæ•´åŸå› </label>
                                <textarea class="form-control" 
                                          v-model="bettingLimitData.reason" 
                                          rows="3" 
                                          placeholder="è¯·è¾“å…¥è°ƒæ•´é™çº¢çš„åŸå› ï¼ˆå¯é€‰ï¼‰"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="hideBettingLimitModal">å–æ¶ˆ</button>
                        <button type="button" 
                                class="btn btn-primary" 
                                @click="submitBettingLimitAdjustment()"
                                :disabled="!bettingLimitData.newLimitLevel || bettingLimitData.submitting">
                            <span v-if="bettingLimitData.submitting" class="spinner-border spinner-border-sm me-2"></span>
                            ç¡®è®¤è°ƒæ•´
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è°ƒæ•´ä»£ç†é™çº¢ Modal - ä½¿ç”¨v-ifæ§åˆ¶æ˜¾ç¤º -->
        <div v-if="showAgentBettingLimitModal && isLoggedIn && user && user.id && modalSystemReady" 
             class="modal d-block" id="adjustAgentBettingLimitModal" tabindex="-1" 
             style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-sliders-h me-2"></i>è°ƒæ•´ä»£ç†é™çº¢è®¾å®š
                        </h5>
                        <button type="button" class="btn-close" @click="hideAgentBettingLimitModal"></button>
                    </div>
                    <div class="modal-body">
                        <!-- è½½å…¥çŠ¶æ€ -->
                        <div v-if="agentBettingLimitData.loading" class="text-center p-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">è½½å…¥ä¸­...</span>
                            </div>
                            <p class="mt-2">è½½å…¥é™çº¢é…ç½®ä¸­...</p>
                        </div>
                        
                        <!-- ä¸»è¦å†…å®¹ -->
                        <div v-else>
                            <!-- ä»£ç†ä¿¡æ¯ -->
                            <div class="alert alert-info">
                                <h6><i class="fas fa-user-tie me-2"></i>ä»£ç†ä¿¡æ¯</h6>
                                <p class="mb-1"><strong>ç”¨æˆ¶å:</strong> {{ agentBettingLimitData.agent.username }}</p>
                                <p class="mb-1"><strong>å½“å‰é™çº¢ç­‰çº§:</strong> 
                                    <span class="badge bg-secondary">{{ agentBettingLimitData.agent.levelDisplayName }}</span>
                                </p>
                                <p class="mb-0"><strong>è¯´æ˜:</strong> {{ agentBettingLimitData.agent.description }}</p>
                            </div>

                            <!-- é‡è¦æç¤º -->
                            <div class="alert alert-warning">
                                <h6><i class="fas fa-exclamation-triangle me-2"></i>é‡è¦æç¤º</h6>
                                <p class="mb-1">â€¢ ä»£ç†çš„é™çº¢ç­‰çº§å†³å®šäº†è©²ä»£ç†å¯ä»¥åˆ›å»ºçš„ä¼šå‘˜å’Œä¸‹ç´šä»£ç†çš„<strong>æœ€é«˜é™çº¢ç­‰çº§</strong></p>
                                <p class="mb-1">â€¢ æ‚¨åªèƒ½å°‡ä»£ç†çš„é™çº¢ç­‰çº§è®¾å®šä¸º<strong>ä¸é«˜æ–¼æ‚¨è‡ªå·±çš„é™çº¢ç­‰çº§</strong></p>
                                <p class="mb-0">â€¢ è°ƒæ•´é™çº¢ç­‰çº§<strong>ä¸ä¼šå½±å“</strong>è©²ä»£ç†å·²åˆ›å»ºçš„ä¼šå‘˜å’Œä¸‹ç´šä»£ç†çš„é™çº¢è®¾å®š</p>
                            </div>

                            <!-- é™çº¢ç­‰çº§é€‰æ‹© -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">é€‰æ‹©æ–°çš„é™çº¢ç­‰çº§</label>
                                <select class="form-select" v-model="agentBettingLimitData.newLimitLevel">
                                    <option value="">è¯·é€‰æ‹©é™çº¢ç­‰çº§</option>
                                    <option v-for="config in agentBettingLimitData.availableConfigs" 
                                            :key="config.level_name" 
                                            :value="config.level_name">
                                        {{ config.level_display_name }} - {{ config.description }}
                                    </option>
                                </select>
                            </div>

                            <!-- é™çº¢é…ç½®é¢„è§ˆ -->
                            <div v-if="agentBettingLimitData.newLimitLevel" class="mb-3">
                                <h6><i class="fas fa-eye me-2"></i>é™çº¢é…ç½®é¢„è§ˆ</h6>
                                <div class="table-responsive">
                                    <table class="table table-sm table-bordered">
                                        <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                            <tr>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç©æ³•</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å–®æ³¨æœ€é«˜</th>
                                                <th style="color: white; font-weight: bold; background-color: #1e3a8a;">å–®æœŸé™é¢</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="(config, key) in selectedAgentLimitConfig" :key="key">
                                                <td>{{ formatBetTypeName(key) }}</td>
                                                <td class="text-success fw-bold">{{ formatMoney(config.maxBet) }}</td>
                                                <td class="text-primary fw-bold">{{ formatMoney(config.periodLimit) }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- è°ƒæ•´åŸå›  -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">è°ƒæ•´åŸå› </label>
                                <textarea class="form-control" 
                                          v-model="agentBettingLimitData.reason" 
                                          rows="3" 
                                          placeholder="è¯·è¾“å…¥è°ƒæ•´é™çº¢çš„åŸå› ï¼ˆå¯é€‰ï¼‰"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="hideAgentBettingLimitModal">å–æ¶ˆ</button>
                        <button type="button" 
                                class="btn btn-primary" 
                                @click="submitAgentBettingLimitAdjustment()"
                                :disabled="!agentBettingLimitData.newLimitLevel || agentBettingLimitData.submitting">
                            <span v-if="agentBettingLimitData.submitting" class="spinner-border spinner-border-sm me-2"></span>
                            ç¡®è®¤è°ƒæ•´
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¼šå‘˜æ³¨å–®è¯¦æƒ…Modal -->
    <div class="modal fade" id="memberBetDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-list-alt me-2"></i>{{ memberBetDetails.memberUsername }} - æ³¨å–®è¯¦æƒ…
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- ç­›é€‰æ¢ä»¶ -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">å¼€å§‹æ—¥æœŸ</label>
                            <input type="date" class="form-control" v-model="memberBetDetails.startDate">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">ç»“æŸæ—¥æœŸ</label>
                            <input type="date" class="form-control" v-model="memberBetDetails.endDate">
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-primary me-2" @click="loadMemberBetDetails">
                                <i class="fas fa-search me-1"></i>æŸ¥è¯¢
                            </button>
                            <button class="btn btn-outline-secondary" @click="refreshMemberBetDetails">
                                <i class="fas fa-sync me-1"></i>åˆ·æ–°
                            </button>
                        </div>
                    </div>

                    <!-- æ³¨å–®åˆ—è¡¨ -->
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                <tr>
                                    <th style="width: 120px; color: white; font-weight: bold; background-color: #1e3a8a;">å•å·</th>
                                    <th style="width: 130px; color: white; font-weight: bold; background-color: #1e3a8a;">æŠ•æ³¨æ—¶é—´</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">éŠæˆ²</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">æŠ•æ³¨å†…å®¹</th>
                                    <th style="width: 80px; color: white; font-weight: bold; background-color: #1e3a8a;">ä¸‹æ³¨é‡‘é¢</th>
                                    <th style="width: 60px; color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´</th>
                                    <th style="width: 80px; color: white; font-weight: bold; background-color: #1e3a8a;">ä¸‹æ³¨ç»“æœ</th>
                                    <th style="width: 90px; color: white; font-weight: bold; background-color: #1e3a8a; white-space: nowrap;">æœ¬ç´šä½”æˆ</th>
                                    <th style="width: 80px; color: white; font-weight: bold; background-color: #1e3a8a;">æœ¬ç´šç»“æœ</th>
                                    <th style="width: 100px; color: white; font-weight: bold; background-color: #1e3a8a;">ä½”æˆæ˜ç»†</th>
                                    <th style="width: 100px; color: white; font-weight: bold; background-color: #1e3a8a;">æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="bet in memberBetDetails.bets" :key="bet.id">
                                    <td class="text-monospace small">{{ bet.period }}{{ String(bet.id).padStart(3, '0') }}</td>
                                    <td class="small">{{ formatBetTime(bet.created_at) }}</td>
                                    <td class="small">æ³¢å ´èµ›è½¦(1åˆ†)<br>{{ bet.period }}æœŸ</td>
                                    <td class="fw-bold">{{ bet.username }}</td>
                                    <td>
                                        <div class="small">
                                            {{ bet.market_type }}ç›¤<br>
                                            {{ formatBetContent(bet) }}<br>
                                            <span class="text-muted">@ {{ bet.odds }}</span>
                                        </div>
                                    </td>
                                    <td class="text-end">{{ formatMoney(bet.amount) }}</td>
                                    <td class="text-center">{{ (bet.rebate_percentage * 100).toFixed(1) }}%</td>
                                    <td class="text-end" :class="bet.win ? 'text-success' : 'text-danger'">
                                        {{ bet.win ? '+' + formatMoney(bet.win_amount - bet.amount) : '-' + formatMoney(bet.amount) }}
                                    </td>
                                    <td class="text-center">{{ bet.commission_percentage || '0' }}%</td>
                                    <td class="text-end">{{ formatMoney(bet.commission_amount || 0) }}</td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-outline-info" @click="showCommissionDetails(bet)">
                                            æ˜ç»†
                                        </button>
                                    </td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-outline-success" @click="showDrawResult(bet.period)">
                                            å¼€å¥–ç»“æœ
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ç©ºçŠ¶æ€ -->
                    <div v-if="memberBetDetails.bets.length === 0" class="text-center py-5">
                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                        <p class="text-muted">æš«ç„¡æ³¨å–®è®°å½•</p>
                    </div>

                    <!-- åˆ†é¡µ -->
                    <nav v-if="memberBetDetails.totalPages > 1">
                        <ul class="pagination justify-content-center">
                            <li class="page-item" :class="{disabled: memberBetDetails.currentPage === 1}">
                                <a class="page-link" href="#" @click.prevent="changeMemberBetPage(memberBetDetails.currentPage - 1)">ä¸Šä¸€é¡µ</a>
                            </li>
                            <li class="page-item" v-for="page in getMemberBetPageRange()" :key="page" :class="{active: page === memberBetDetails.currentPage}">
                                <a class="page-link" href="#" @click.prevent="changeMemberBetPage(page)">{{ page }}</a>
                            </li>
                            <li class="page-item" :class="{disabled: memberBetDetails.currentPage === memberBetDetails.totalPages}">
                                <a class="page-link" href="#" @click.prevent="changeMemberBetPage(memberBetDetails.currentPage + 1)">ä¸‹ä¸€é¡µ</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- ä½”æˆæ˜ç»†Modal -->
    <div class="modal fade" id="commissionDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ä½”æˆæ˜ç»†</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead style="background-color: #1e3a8a; color: white; font-weight: bold;">
                                <tr>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç±»å‹</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ç”¨æˆ¶å</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">ä½”æˆ</th>
                                    <th style="color: white; font-weight: bold; background-color: #1e3a8a;">é€€æ°´</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="detail in commissionDetails" :key="detail.id">
                                    <td>{{ detail.level_name }}</td>
                                    <td>{{ detail.username }}</td>
                                    <td class="text-end">{{ detail.commission_percentage }}%</td>
                                    <td class="text-end">{{ detail.rebate_percentage }}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼€å¥–ç»“æœModal -->
    <div class="modal fade" id="drawResultModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">å¼€å¥–ç»“æœ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <h6 class="mb-3">æœŸè™Ÿï¼š{{ drawResult.period }}</h6>
                    <div class="draw-balls-container d-flex justify-content-center flex-wrap gap-2">
                        <div v-for="(number, index) in drawResult.numbers" :key="index" class="text-center">
                            <div class="small text-muted mb-1">ç¬¬{{ getPositionName(index + 1) }}å</div>
                            <div class="number-ball mx-auto" :class="'color-' + number" style="width: 50px; height: 50px; line-height: 50px; border-radius: 50%; color: white; font-weight: bold; background-color: #1e3a8a;">{{ number }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å®¢æœå­˜æ¬¾/ææ¬¾æ“ä½œ Modal -->
    <div class="modal fade" id="csOperationModal" tabindex="-1" aria-labelledby="csOperationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="csOperationModalLabel">å®¢æœå­˜æ¬¾/ææ¬¾æ“ä½œ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="csOperationForm">
                        <!-- æ“ä½œå¯¹è±¡ -->
                        <div class="mb-3">
                            <label class="form-label">æ“ä½œå¯¹è±¡</label>
                            <div class="btn-group w-100">
                                <input type="radio" class="btn-check" name="csOperationTarget" id="csTargetAgent" value="agent">
                                <label class="btn btn-outline-primary" for="csTargetAgent">ä»£ç†</label>
                                
                                <input type="radio" class="btn-check" name="csOperationTarget" id="csTargetMember" value="member">
                                <label class="btn btn-outline-info" for="csTargetMember">ä¼šå‘˜</label>
                            </div>
                        </div>
                        
                        <!-- é€‰æ‹©ä»£ç† -->
                        <div class="mb-3" id="agentSelectDiv" style="display: none;">
                            <label class="form-label">é€‰æ‹©ä»£ç†</label>
                            <select id="agentSelect" class="form-select" required>
                                <option value="">è¯·é€‰æ‹©ä»£ç†</option>
                            </select>
                        </div>
                        
                        <!-- é€‰æ‹©ä¼šå‘˜ -->
                        <div class="mb-3" id="memberSelectDiv" style="display: none;">
                            <label class="form-label">é€‰æ‹©ä¼šå‘˜</label>
                            <select id="memberSelect" class="form-select" required>
                                <option value="">è¯·é€‰æ‹©ä¼šå‘˜</option>
                            </select>
                        </div>
                        
                        <!-- å½“å‰ä½™é¢æ˜¾ç¤º -->
                        <div class="row mb-3" id="currentBalanceDiv" style="display: none;">
                            <div class="col-md-12">
                                <label class="form-label">å½“å‰ä½™é¢</label>
                                <input id="currentBalanceInput" type="text" class="form-control" disabled>
                            </div>
                        </div>
                        
                        <!-- æ“ä½œç±»å‹ -->
                        <div class="mb-3" id="operationTypeDiv" style="display: none;">
                            <label class="form-label">æ“ä½œç±»å‹</label>
                            <div class="btn-group w-100">
                                <input type="radio" class="btn-check" name="csTransferType" id="csDeposit" value="deposit">
                                <label class="btn btn-outline-success" for="csDeposit">å­˜æ¬¾</label>
                                
                                <input type="radio" class="btn-check" name="csTransferType" id="csWithdraw" value="withdraw">
                                <label class="btn btn-outline-danger" for="csWithdraw">ææ¬¾</label>
                            </div>
                        </div>
                        
                        <!-- æ“ä½œé‡‘é¢ -->
                        <div class="mb-3" id="amountDiv" style="display: none;">
                            <label class="form-label">æ“ä½œé‡‘é¢</label>
                            <div class="input-group">
                                <input type="number" step="0.01" class="form-control" id="amountInput"
                                       placeholder="è¯·è¾“å…¥æ“ä½œé‡‘é¢" min="0" required>
                                <span class="input-group-text">å…ƒ</span>
                            </div>
                        </div>
                        
                        <!-- æ“ä½œå¾Œä½™é¢é¢„è§ˆ -->
                        <div class="mb-3" id="finalBalanceDiv" style="display: none;">
                            <label class="form-label">æ“ä½œå¾Œä½™é¢</label>
                            <input id="finalBalanceInput" type="text" class="form-control" disabled>
                        </div>
                        
                        <!-- æ“ä½œè¯´æ˜ -->
                        <div class="mb-3">
                            <label class="form-label">æ“ä½œè¯´æ˜</label>
                            <textarea class="form-control" id="csOperationDescription"
                                      placeholder="è¯·è¾“å…¥æ“ä½œè¯´æ˜ï¼ˆå¯é€‰ï¼‰" rows="3"></textarea>
                        </div>
                        
                        <div class="text-end">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">å–æ¶ˆ</button>
                            <button type="button" class="btn btn-primary" id="csOperationSubmitBtn">
                                <span id="csOperationSpinner" class="spinner-border spinner-border-sm" role="status" style="display: none;"></span>
                                ç¡®è®¤æ“ä½œ
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- ä¸»è¦JSæ–‡ä»¶ - æ·»åŠ ç‰ˆæœ¬è™Ÿé˜²æ­¢ç·©å­˜ -->
    <script src="js/main.js?v=20250723001"></script>
    <script>
        async function updateProfile() {
            console.log('å¼€å§‹æ›´æ–°ä¸ªäººèµ„æ–™...');
            this.profileLoading = true;
            try {
                console.log('å‡†å¤‡é€å‡º axios è¯·æ±‚');
                const response = await axios.post(/* ... */);
                console.log('æ”¶åˆ°APIå›åº”:', response.data);
                if (response.data.success) {
                    console.log('APIæˆåŠŸï¼Œå‡†å¤‡å…³é—­modal');
                } else {
                    console.log('APIå¤±è´¥:', response.data.message);
                }
            } catch (error) {
                console.error('catch error:', error);
            } finally {
                console.log('finally: profileLoading è¨­ä¸º false');
                this.profileLoading = false;
            }
        }
    </script>
</body>
</html>
