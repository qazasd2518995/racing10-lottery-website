# 洗球動畫持續播放修復

## 問題描述
用戶反映開獎中倒數結束時會先卡幾秒在0秒顯示舊的球號，等到封盤倒計時開始時，又會刷新才有新的開獎球號。

## 根本原因
原本的邏輯在開獎倒數結束時（從 drawing 狀態轉換到 betting 狀態）會立即停止洗球動畫，但此時新的開獎結果可能還沒準備好，導致顯示舊的球號。

## 解決方案
修改 `completeDrawingProcess()` 函數的邏輯：

### 修改前：
- 立即停止洗球動畫
- 如果有緩存結果就使用緩存
- 如果沒有才從 API 獲取

### 修改後：
- **繼續播放洗球動畫**，不立即停止
- 同時從 API 獲取最新結果
- 只有在獲取到新結果後才停止動畫並顯示
- 如果暫時無法獲取結果，會自動重試（最多10次）

## 技術實現
```javascript
// 修改後的 completeDrawingProcess
completeDrawingProcess() {
    // ... 前置檢查 ...
    
    // 繼續播放洗球動畫，直到獲取到新結果
    console.log('📊 繼續洗球動畫，同時獲取最新開獎結果...');
    
    this.getLatestResultFromHistory().then((latestResult) => {
        if (latestResult && latestResult.length === 10) {
            // 現在才停止動畫並顯示新結果
            this.stopWashingAnimation();
        } else {
            // 繼續嘗試獲取結果
            setTimeout(() => {
                this.retryGetResult();
            }, 1000);
        }
    });
}
```

## 新增功能
1. **retryGetResult()** - 重試機制，確保最終能獲取到結果
2. **持續動畫** - 洗球動畫會持續播放直到新結果準備好
3. **智能重試** - 最多重試10次，每次間隔1秒

## 效果
- 開獎倒數結束後，洗球動畫會繼續播放
- 不會出現顯示舊球號的空檔期
- 當新的開獎結果準備好時，動畫才會停止並立即顯示新結果
- 提升用戶體驗，避免視覺上的不連續性

## 測試建議
1. 觀察開獎倒計時從 1 秒到 0 秒的轉換
2. 確認洗球動畫持續播放，沒有中斷
3. 確認新球號在動畫停止時立即顯示，沒有舊球號閃現